<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />





  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "bb54c613"
    });
  daovoice('update');
  </script>














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="NIRVANA" type="application/atom+xml" />






<script>
    (function(){
        if(''){
            if (prompt('Password') !== ''){
                alert('ERROR! Wrong Password!');
                history.back();
            }
        }
    })();
</script>


<meta name="description" content="Veni, Vidi, Vici">
<meta property="og:type" content="website">
<meta property="og:title" content="NIRVANA">
<meta property="og:url" content="http://azrael.top/page/7/index.html">
<meta property="og:site_name" content="NIRVANA">
<meta property="og:description" content="Veni, Vidi, Vici">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NIRVANA">
<meta name="twitter:description" content="Veni, Vidi, Vici">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://azrael.top/page/7/"/>





  <title>NIRVANA</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
	  <div class="headband"></div>

	  <a href="https://github.com/AzraelDeath/" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">NIRVANA</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            HOME
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            TAGS
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            ARCHIVES
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            SITEMAP
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            SEARCH
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://azrael.top/BZOJ1026【SCOI2009】Windy数 数位DP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Azrael_Death">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/BZOJ1026【SCOI2009】Windy数 数位DP/" itemprop="url">BZOJ1026【SCOI2009】Windy数 <数位DP></a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  445
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="【SCOI2009】windy数"><a href="#【SCOI2009】windy数" class="headerlink" title="【SCOI2009】windy数"></a>【SCOI2009】windy数</h2><p>Time Limit: $1 Sec$<br>Memory Limit: $162 MB$</p>
</blockquote>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>$windy$定义了一种$windy$数。不含前导零且相邻两个数字之差至少为$2$的正整数被称为$windy$数。 $windy$想知道，在$A$和$B$之间，包括$A$和$B$，总共有多少个$windy$数？</p>
<blockquote>
</blockquote>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>包含两个整数，$A,B$。</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>一个整数</p>
<blockquote>
</blockquote>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><p>【输入样例一】<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 10</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>【输入样例二】<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">25 50</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><p>【输出样例一】<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>【输出样例二】<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">20</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<h3 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h3><p>【数据规模和约定】<br> $100\%$的数据，满足 $1\le A \le B \le 2\times 10^9$ 。</p>
</blockquote>
<p>标签：数位$DP$</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>非常经典的一道数位$DP$题。<br>也是多少$OIer$数位$DP$入门的第一题啊…</p>
<p>先预处理出$DP$数组，其中$f[i][j]$从左往右第$i$位为$j$的$windy$数的个数。<br>对于询问，分别计算$[1, A-1]$和$[1, B]$中的$windy$数的个数，即在预处理的表中按位查询，统计答案后相减即可。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">15</span>][<span class="number">15</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">abs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;<span class="keyword">return</span> x &gt;= <span class="number">0</span> ? x : -x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> len = <span class="number">0</span>, n[<span class="number">15</span>], t = x, ret = <span class="number">0</span>;	<span class="keyword">while</span> (t)	n[++len] = t%<span class="number">10</span>, t /= <span class="number">10</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">9</span>; j++)	ret += f[i][j];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = len; i; i--) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = (i == len ? <span class="number">1</span> : <span class="number">0</span>); j &lt; n[i]; j++)	<span class="keyword">if</span> (i == len || <span class="built_in">abs</span>(j-n[i+<span class="number">1</span>]) &gt;= <span class="number">2</span>)	ret += f[i][j];</span><br><span class="line">		<span class="keyword">if</span> (i &lt; len &amp;&amp; <span class="built_in">abs</span>(n[i+<span class="number">1</span>]-n[i]) &lt; <span class="number">2</span>)	<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; i++)	f[<span class="number">1</span>][i] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">9</span>; j++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= j<span class="number">-2</span>; k++)	f[i+<span class="number">1</span>][k] += f[i][j];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = j+<span class="number">2</span>; k &lt;= <span class="number">9</span>; k++)	f[i+<span class="number">1</span>][k] += f[i][j];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> l, r;	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l, &amp;r);	<span class="built_in">printf</span>(<span class="string">"%d"</span>, calc(r+<span class="number">1</span>)-calc(l));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://azrael.top/BZOJ1033【ZJOI2007】杀蚂蚁 模拟/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Azrael_Death">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/BZOJ1033【ZJOI2007】杀蚂蚁 模拟/" itemprop="url">BZOJ1033【ZJOI2007】杀蚂蚁 <模拟></a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-27T00:00:00+08:00">
                2017-10-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,215
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  19
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="【ZJOI2008】杀蚂蚁"><a href="#【ZJOI2008】杀蚂蚁" class="headerlink" title="【ZJOI2008】杀蚂蚁"></a>【ZJOI2008】杀蚂蚁</h2></blockquote>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>最近，佳佳迷上了一款好玩的小游戏：$antbuster$。<br>游戏规则非常简单：在一张地图上，左上角是蚂蚁窝，右下角是蛋糕，蚂蚁会源源不断地从窝里爬出来，试图把蛋糕搬回蚂蚁窝。而你的任务，就是用原始资金以及杀蚂蚁获得的奖金造防御塔，杀掉这些试图跟你抢蛋糕的蚂蚁~<br>下附一张游戏截图：</p>
<p><center><br><img src="http://www.lydsy.com/JudgeOnline/images/1033/1.jpg" alt=""><br>&lt;\center&gt;<br>为了拿到尽可能高的分数，佳佳设计了很多种造塔的方案，但在尝试了其中的一小部分后，佳佳发现，这个游戏实在是太费时间了。为了节省时间，佳佳决定写个程序，对于每一种方案，模拟游戏进程，根据效果来判断方案的优劣。<br>根据自己在游戏中积累的一些经验，以及上网搜到的一些参数，佳佳猜了蚂蚁爬行的算法，并且假设游戏中的蚂蚁也是按这个规则选择路线：</center></p>
<pre><code>1. 每一秒钟开始的时候，蚂蚁都在平面中的某个整点上。如果蚂蚁没有扛着蛋糕，它会在该点留下 2 单位的信息素，否则它会留下 5 单位的信息素。然后蚂蚁会在正北、正南、正东、正西四个方向中选择一个爬过去。
2. 选择方向的规则是：首先，爬完一个单位长度后到达的那个点上，不能有其他蚂蚁或是防御塔，并且那个点不能是蚂蚁上一秒所在的点（除非上一个时刻蚂蚁就被卡住，且这个时刻它仍无法动），当然，蚂蚁也不会爬出地图的边界（我们定义这些点为不可达点）。如果此时有多个选择，蚂蚁会选择信息素最多的那个点爬过去。
3. 如果此时仍有多种选择，蚂蚁先面向正东，如果正东不是可选择的某个方向，它会顺时针转90°，再次判断，如果还不是，再转 90°...直到找到可以去的方向。
4. 如果将每只蚂蚁在洞口出现的时间作为它的活动时间的第 1 秒，那么每当这只蚂蚁的活动时间秒数为 5 的倍数的时候，它先按规则 1~3 确定一个方向，面对该方向后逆时针转 90°，若它沿当前方向会走到一个不可达点，它会不停地每次逆时针转 90°，直到它面对着一个可达的点，这样定下的方向才是蚂蚁最终要爬去的方向。
5. 如果蚂蚁的四周都是不可达点，那么蚂蚁在这一秒内会选择停留在当前点。下一秒判断移动方向时，它上一秒所在点为其当前停留的点。
6. 你可以认为蚂蚁在选定方向后，瞬间移动到它的目标点，这一秒钟剩下的时间里，它就停留在目标点。
7. 蚂蚁按出生的顺序移动，出生得比较早的蚂蚁先移动。
</code></pre><p>然后，是一些有关地图的信息：</p>
<pre><code>1. 每一秒，地图所有点上的信息素会损失 1 单位，如果那个点上有信息素的话。
2. 地图上某些地方是炮台。炮台的坐标在输入中给出。
3. 地图的长、宽在输入中给出，对于n*m的地图，它的左上角坐标为(0,0)，右下角坐标为(n,m)。蚂蚁洞的位置为(0,0)，蛋糕的位置为(n,m)。
4. 你可以把蚂蚁看做一个直径为 1 单位的圆，圆心位于蚂蚁所在的整点。
5. 游戏开始时，地图上没有蚂蚁，每个点上的信息素含量均为 0。
</code></pre><p>一些有关炮塔的信息：</p>
<pre><code>1. 炮塔被放置在地图上的整点处。
2. 为了简单一些，我们认为这些炮塔都是激光塔。激光塔的射速是 1 秒/次，它的攻击伤害为 d/次，攻击范围为 r。你可以认为每秒蚂蚁移动完毕后，塔才开始攻击。并且，只有当代表蚂蚁的圆的圆心与塔的直线距离不超过 r 时，塔才算打得到那只蚂蚁。
3. 如果一只蚂蚁扛着蛋糕，那么它会成为 target，也就是说，任何打得到它的塔的炮口都会对准它。如果蛋糕好好地呆在原位，那么每个塔都会挑离它最近的蚂蚁进行攻击，如果有多只蚂蚁，它会选出生较早的一只。
4. 激光塔有个比较奇怪的特性：它在选定了打击目标后，只要目标在其射程内，塔到目标蚂蚁圆心的连线上的所有蚂蚁（这里“被打到”的判定变成了表示激光的线段与表示蚂蚁的圆有公共点）都会被打到并损 d 格血，但激光不会穿透它的打击目标打到后面的蚂蚁。
5. 尽管在真实游戏中，塔是可以升级的，但在这里我们认为塔的布局和等级就此定了下来，不再变动。
</code></pre><p>再介绍一下蚂蚁窝：</p>
<pre><code>1. 如果地图上的蚂蚁不足 6 只，并且洞口没有蚂蚁，那么窝中每秒会爬出一只蚂蚁，直到地图上的蚂蚁数为 6 只。
2. 刚出生的蚂蚁站在洞口。3. 每只蚂蚁有一个级别，级别决定了蚂蚁的血量，级别为 k 的蚂蚁的血量为[4*1.1^k]。每被塔打一次，蚂蚁的血减少 d。注意，血量为 0 的蚂蚁仍能精力充沛地四处乱爬，只有一只蚂蚁的血被打成负数时，它才算挂了。
3. 蚂蚁的级别是这样算的：前 6 只出生的蚂蚁是 1 级，第 7~12 只是 2 级，依此类推。
</code></pre><p>最后给出关于蛋糕的介绍：</p>
<pre><code>1. 简单起见，你可以认为此时只剩最后一块蛋糕了。如果有蚂蚁走到蛋糕的位置，并且此时蛋糕没有被扛走，那么这只蚂蚁就扛上了蛋糕。蚂蚁被打死后蛋糕归位。
2. 如果一只扛着蛋糕的蚂蚁走到蚂蚁窝的位置，我们就认为蚂蚁成功抢到了蛋糕，游戏结束。
3. 蚂蚁扛上蛋糕时，血量会增加[该蚂蚁出生时血量/2]，但不会超过上限。
</code></pre><p>整理一下 1 秒钟内发生的事件：</p>
<pre><code>1. 1 秒的最初，如果地图上蚂蚁数不足 6，一只蚂蚁就会在洞口出生。
2. 接着，蚂蚁们在自己所在点留下一些信息素后，考虑移动。先出生的蚂蚁先移动。
3. 移动完毕后，如果有蚂蚁在蛋糕的位置上并且蛋糕没被拿走，它把蛋糕扛上，血量增加，并在这时被所有塔设成 target。
4. 然后所有塔同时开始攻击。如果攻击结束后那只扛着蛋糕的蚂蚁挂了，蛋糕瞬间归位。
5. 攻击结束后，如果发现扛蛋糕的蚂蚁没死并在窝的位置，就认为蚂蚁抢到了蛋糕。游戏也在此时结束。
6. 最后，地图上所有点的信息素损失 1 单位。所有蚂蚁的年龄加 1。
7. 漫长的 1 秒到此结束。
</code></pre><blockquote>
</blockquote>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>输入的第一行是 $2$ 个用空格隔开的整数， $n$、$m$，分别表示了地图的长和宽。<br>第二行是 $3$ 个用空格隔开的整数， $s$、 $d$、 $r$，依次表示炮塔的个数、单次攻击伤害以及攻击范围。接下来 $s$ 行，每行是 $2$ 个用空格隔开的整数 $x$、 $y$，描述了一个炮塔的位置。当然，蚂蚁窝的洞口以及蛋糕所在的位置上一定没有炮塔。<br>最后一行是一个正整数 $t$，表示我们模拟游戏的前 $t$ 秒钟。</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>如果在第 $t$ 秒或之前蚂蚁抢到了蛋糕，输出一行“$Game  over  after  x  seconds$”，其中$x$为游戏结束的时间，否则输出“$The  game  is  going  on$”。<br>如果游戏在 $t$ 秒或之前结束，输出游戏结束时所有蚂蚁的信息，否则输出 $t$ 秒后所有蚂蚁的信息。<br>格式如下：第一行是 $1$ 个整数 $s$，表示此时活着的蚂蚁的总数。接下来 $s$ 行，每行 $5$ 个整数，依次表示一只蚂蚁的年龄（单位为秒）、等级、当前血量，以及在地图上的位置$(a,b)$。输出按蚂蚁的年龄递减排序。</p>
<blockquote>
</blockquote>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3 5</span><br><span class="line">1 1 2</span><br><span class="line">2 2</span><br><span class="line">5</span><br></pre></td></tr></table></figure>
<blockquote>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">The game is going on</span><br><span class="line">5</span><br><span class="line">5 1 3 1 4</span><br><span class="line">4 1 3 0 4</span><br><span class="line">3 1 3 0 3</span><br><span class="line">2 1 3 0 2</span><br><span class="line">1 1 4 0 1</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a>Hint</h3><p>样例说明：<br>$3\times 5$的地图，有$1$个单次伤害为$1$、攻击范围为$2$的激光炮塔，它的位置为$(2,2)$，模拟游戏的前$5$秒。$5$秒内有$5$只蚂蚁出生，都是向东爬行，其中第$1\sim 4$只在路过$(0,2)$点时被激光塔伤了$1$格血。在第$5$秒的时候，最早出生的蚂蚁按移动规则$1\sim 3$本来该向东移动，但由于规则$4$的作用，它在发现向北和向西移动都会到达不可达点后，最终选择了向南移动。<br>数据说明：<br>$100\%$的数据满足$1\le n,m\le 8$，$s\le 20$，$t\le 2\times 10^5$</p>
</blockquote>
<p>如果觉得此题面不好看，请戳这里：<a href="https://www.zybuluo.com/Jerusalem/note/221811" target="_blank" rel="noopener">https://www.zybuluo.com/Jerusalem/note/221811</a><br>如果做得无聊了，可以玩玩：<a href="http://wanga.me/2794" target="_blank" rel="noopener">http://wanga.me/2794</a></p>
<p>标签：大模拟</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>这是那种“做一做，一个下午就没了”的恶心题。<br>我从上午十一点开做，足足做到晚上七点半才做完。<br>恶心~</p>
<p>大模拟，题面已经比较清楚了。<br>坑点如下：</p>
<ol>
<li>蚂蚁既是一个点，也是一个直径为$1$的圆（注意，是直径！）<br>即在判断一个炮台和一只蚂蚁的距离时，应取圆心与炮台距离，但在判断一只蚂蚁是否会被炮台顺带打到，即在打目标蚂蚁的路径上时，应判断激光直线是否与圆有交点。</li>
<li>新出生的蚂蚁刚从蚁巢里出来时，要标记$(0,0)$为有物体，否则回来的蚂蚁会和它重在一起。</li>
<li>若当前蚂蚁出生的时间为$t$，则其年龄为$t-1$。</li>
<li>寻找移动方向时，应先按规则$1\sim 3$选择下一个位置。如果出生时间为$5$的倍数，则应该逆时针（注意，是逆时针）旋转，并且找到一个可行方向就走过去，不考虑信息素多少。</li>
<li>所有炮台是一起开炮，所以应该先把所有炮台的目标确定后，再统一扣蚂蚁的生命值。这样会出现蚂蚁生命在同一秒内被扣成负数还要继续扣的情况，这样就是正确的。</li>
</ol>
<h3 id="Extra-Samples"><a href="#Extra-Samples" class="headerlink" title="Extra Samples"></a>Extra Samples</h3><p>贡献几组数据，可自测：</p>
<h5 id="Sample-1"><a href="#Sample-1" class="headerlink" title="Sample #1"></a>Sample #1</h5><p><strong>Input</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">4 4</span><br><span class="line">4 10 5</span><br><span class="line">1 1</span><br><span class="line">2 2</span><br><span class="line">1 2</span><br><span class="line">2 1</span><br><span class="line">1000</span><br></pre></td></tr></table></figure></p>
<p><strong>Output</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Game over after 831 seconds</span><br><span class="line">6</span><br><span class="line">110 49 86 2 3</span><br><span class="line">88 49 26 0 1</span><br><span class="line">77 49 286 3 1</span><br><span class="line">58 50 29 0 0</span><br><span class="line">22 50 419 4 3</span><br><span class="line">10 50 469 3 2</span><br></pre></td></tr></table></figure></p>
<h5 id="Sample-2"><a href="#Sample-2" class="headerlink" title="Sample #2"></a>Sample #2</h5><p><strong>Input</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">6 4</span><br><span class="line">1 10000 10</span><br><span class="line">2 2</span><br><span class="line">256</span><br></pre></td></tr></table></figure></p>
<p><strong>Output</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The game is going on</span><br><span class="line">0</span><br></pre></td></tr></table></figure></p>
<h5 id="Sample-3"><a href="#Sample-3" class="headerlink" title="Sample #3"></a>Sample #3</h5><p><strong>Input</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4 7</span><br><span class="line">0 0 0</span><br><span class="line">60200</span><br></pre></td></tr></table></figure></p>
<p><strong>Output</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Game over after 60200 seconds</span><br><span class="line">6</span><br><span class="line">60199 1 4 0 0</span><br><span class="line">60198 1 4 2 6</span><br><span class="line">60197 1 4 4 7</span><br><span class="line">60196 1 4 2 1</span><br><span class="line">60195 1 4 3 5</span><br><span class="line">60194 1 4 4 5</span><br></pre></td></tr></table></figure></p>
<h5 id="Sample-4"><a href="#Sample-4" class="headerlink" title="Sample #4"></a>Sample #4</h5><p><strong>Input</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">2 5</span><br><span class="line">6 1 3</span><br><span class="line">0 1</span><br><span class="line">1 1</span><br><span class="line">1 3</span><br><span class="line">1 4</span><br><span class="line">2 3</span><br><span class="line">2 4</span><br><span class="line">200000</span><br></pre></td></tr></table></figure></p>
<p><strong>Output</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">The game is going on</span><br><span class="line">6</span><br><span class="line">15311 86 13525 1 5</span><br><span class="line">12518 86 10203 0 5</span><br><span class="line">9447 87 12495 0 4</span><br><span class="line">6371 87 13461 0 3</span><br><span class="line">3295 87 14586 0 2</span><br><span class="line">219 87 15873 1 2</span><br></pre></td></tr></table></figure></p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>（$BZOJ$上$A$了，洛谷上死活$WA$一个点，不知道为什么）<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EPS 1e-5</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> dnt;</span><br><span class="line"><span class="keyword">int</span> n, m, s, d, r, cnt, num, tar = <span class="number">-1</span>;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; living;	<span class="keyword">int</span> information[<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line"><span class="keyword">bool</span> lose = <span class="literal">false</span>, cake = <span class="literal">true</span>, is_taken[<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> nxt[<span class="number">4</span>][<span class="number">2</span>] = &#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc_lim_blood</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;dnt ret = <span class="number">4</span>;	<span class="keyword">while</span> (k--)	ret *= <span class="number">1.1</span>;	<span class="keyword">return</span> (<span class="keyword">int</span>)<span class="built_in">floor</span>(ret);&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ant</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> x, y, id, px, py;	<span class="keyword">bool</span> has_cake;</span><br><span class="line">	<span class="keyword">int</span> cur_blood, lim_blood, level, age;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">birth</span><span class="params">(<span class="keyword">int</span> _id)</span> </span>&#123;</span><br><span class="line">		living.push_back(id = _id), num++, has_cake = <span class="literal">false</span>;</span><br><span class="line">		x = y = age = <span class="number">0</span>, px = py = <span class="number">-1</span>, level = id/<span class="number">6</span>+<span class="number">1</span>;</span><br><span class="line">		cur_blood = lim_blood = calc_lim_blood(level), is_taken[x][y] = <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">dead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		num--;	<span class="keyword">int</span> pos;</span><br><span class="line">		<span class="keyword">for</span> (pos = <span class="number">0</span>; pos &lt; (<span class="keyword">int</span>)living.size(); pos++)	<span class="keyword">if</span> (living[pos] == id)	<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">for</span> (; pos &lt; (<span class="keyword">int</span>)living.size()<span class="number">-1</span>; pos++)	living[pos] = living[pos+<span class="number">1</span>];</span><br><span class="line">		living.erase(living.end()<span class="number">-1</span>);</span><br><span class="line">		<span class="keyword">if</span> (has_cake)	cake = <span class="literal">true</span>, tar = <span class="number">-1</span>;	is_taken[x][y] = <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">recover</span><span class="params">()</span> </span>&#123;cur_blood = min(cur_blood+(<span class="keyword">int</span>)<span class="built_in">floor</span>(lim_blood/<span class="number">2</span>), lim_blood);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">hurt</span><span class="params">()</span> </span>&#123;cur_blood -= d;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">left_information</span><span class="params">()</span> </span>&#123;information[x][y] += has_cake ? <span class="number">5</span> : <span class="number">2</span>;&#125;</span><br><span class="line">	pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; choose_direction() &#123;</span><br><span class="line">		<span class="keyword">int</span> nx = <span class="number">-1</span>, ny = <span class="number">-1</span>, cur;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">			<span class="keyword">int</span> tx = x+nxt[i][<span class="number">0</span>], ty = y+nxt[i][<span class="number">1</span>];</span><br><span class="line">			<span class="keyword">if</span> (tx &lt; <span class="number">0</span> || tx &gt; n || ty &lt; <span class="number">0</span> || ty &gt; m)	<span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (is_taken[tx][ty] || (tx == px &amp;&amp; ty == py))	<span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (nx == <span class="number">-1</span> &amp;&amp; ny == <span class="number">-1</span>)	nx = tx, ny = ty;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (information[tx][ty] &gt; information[nx][ny])	nx = tx, ny = ty;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> ((age+<span class="number">1</span>)%<span class="number">5</span> == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (nx == x &amp;&amp; ny == y+<span class="number">1</span>)	nx = ny = <span class="number">-1</span>, cur = <span class="number">0</span>;	<span class="keyword">if</span> (nx == x+<span class="number">1</span> &amp;&amp; ny == y)	nx = ny = <span class="number">-1</span>, cur = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span> (nx == x &amp;&amp; ny == y<span class="number">-1</span>)	nx = ny = <span class="number">-1</span>, cur = <span class="number">2</span>;	<span class="keyword">if</span> (nx == x<span class="number">-1</span> &amp;&amp; ny == y)	nx = ny = <span class="number">-1</span>, cur = <span class="number">3</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = cur<span class="number">-1</span>; ~i; i--) &#123;</span><br><span class="line">				<span class="keyword">int</span> tx = x+nxt[i][<span class="number">0</span>], ty = y+nxt[i][<span class="number">1</span>];</span><br><span class="line">				<span class="keyword">if</span> (tx &lt; <span class="number">0</span> || tx &gt; n || ty &lt; <span class="number">0</span> || ty &gt; m)	<span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span> (is_taken[tx][ty] || (tx == px &amp;&amp; ty == py))	<span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span> (nx == <span class="number">-1</span> &amp;&amp; ny == <span class="number">-1</span>)	nx = tx, ny = ty;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &gt;= cur; i--) &#123;</span><br><span class="line">				<span class="keyword">int</span> tx = x+nxt[i][<span class="number">0</span>], ty = y+nxt[i][<span class="number">1</span>];</span><br><span class="line">				<span class="keyword">if</span> (tx &lt; <span class="number">0</span> || tx &gt; n || ty &lt; <span class="number">0</span> || ty &gt; m)	<span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span> (is_taken[tx][ty] || (tx == px &amp;&amp; ty == py))	<span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span> (nx == <span class="number">-1</span> &amp;&amp; ny == <span class="number">-1</span>)	nx = tx, ny = ty;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> make_pair(nx, ny);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; np = choose_direction();</span><br><span class="line">		<span class="keyword">if</span> (np.first == <span class="number">-1</span> &amp;&amp; np.second == <span class="number">-1</span>)	np.first = x, np.second = y;</span><br><span class="line">		is_taken[x][y] = <span class="literal">false</span>, is_taken[np.first][np.second] = <span class="literal">true</span>;</span><br><span class="line">		px = x, py = y, x = np.first, y = np.second;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">can_take_cake</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> x == n &amp;&amp; y == m &amp;&amp; cake;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">take_cake</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (can_take_cake())	recover(), cake = <span class="literal">false</span>, has_cake = <span class="literal">true</span>, tar = id;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">steal_cake</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> x == <span class="number">0</span> &amp;&amp; y == <span class="number">0</span> &amp;&amp; has_cake;&#125;</span><br><span class="line">&#125; ant[<span class="number">2000000</span>];</span><br><span class="line">	<span class="function">dnt <span class="title">dis</span><span class="params">(<span class="keyword">int</span> x1, <span class="keyword">int</span> y1, <span class="keyword">int</span> x2, <span class="keyword">int</span> y2)</span> </span>&#123;<span class="keyword">return</span> (x1-x2)*(x1-x2)+(y1-y2)*(y1-y2);&#125;</span><br><span class="line">	<span class="function">dnt <span class="title">getcos</span><span class="params">(<span class="keyword">int</span> x1, <span class="keyword">int</span> y1, <span class="keyword">int</span> x2, <span class="keyword">int</span> y2, <span class="keyword">int</span> x3, <span class="keyword">int</span> y3)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> a1 = x1-x2, b1 = y1-y2, a2 = x3-x2, b2 = y3-y2;</span><br><span class="line">		<span class="keyword">return</span> (a1*a2+b1*b2)/(dnt)(<span class="built_in">sqrt</span>(dis(x1, y1, x2, y2))*<span class="built_in">sqrt</span>(dis(x3, y3, x2, y2)));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">reach</span><span class="params">(<span class="keyword">int</span> tarid, <span class="keyword">int</span> inid, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">		dnt cos1 = getcos(ant[inid].x, ant[inid].y, x, y, ant[tarid].x, ant[tarid].y);</span><br><span class="line">		dnt cos2 = getcos(ant[inid].x, ant[inid].y, ant[tarid].x, ant[tarid].y, x, y);</span><br><span class="line">		<span class="keyword">if</span> (cos1 &lt; EPS || cos2 &lt; EPS)	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		dnt t = <span class="built_in">sqrt</span>(dis(ant[inid].x, ant[inid].y, x, y))*<span class="built_in">sqrt</span>(<span class="number">1.0</span>-cos1*cos1);	<span class="keyword">return</span> t<span class="number">-0.5</span> &lt; EPS;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Laser</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> x, y;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">dist</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;<span class="keyword">return</span> (x-ant[id].x)*(x-ant[id].x)+(y-ant[id].y)*(y-ant[id].y);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> _x, <span class="keyword">int</span> _y)</span> </span>&#123;x = _x, y = _y, is_taken[x][y] = <span class="literal">true</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">can_hit</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;<span class="keyword">return</span> (x-ant[id].x)*(x-ant[id].x)+(dnt)(y-ant[id].y)*(y-ant[id].y) &lt;= r*r;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">choose_target</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (~tar &amp;&amp; can_hit(tar))	<span class="keyword">return</span> tar;</span><br><span class="line">		<span class="keyword">int</span> ret = <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, cur = living[i]; i &lt; (<span class="keyword">int</span>)living.size(); cur = living[++i])</span><br><span class="line">			<span class="keyword">if</span> (can_hit(cur))	<span class="keyword">if</span> (ret == <span class="number">-1</span> || dist(ret) &gt; dist(cur))	ret = cur;</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">attack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> id = choose_target();	<span class="keyword">if</span> (id == <span class="number">-1</span>)	<span class="keyword">return</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)living.size(); i++)</span><br><span class="line">			<span class="keyword">if</span> (reach(id, living[i], x, y))	ant[living[i]].hurt();</span><br><span class="line">	&#125;</span><br><span class="line">&#125; laser[<span class="number">10</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_age</span><span class="params">()</span> </span>&#123;<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)living.size(); i++)	ant[living[i]].age++;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lose_information</span><span class="params">()</span> </span>&#123;<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; j++) information[i][j] -= (information[i][j] &gt; <span class="number">0</span>);&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">game_over</span><span class="params">()</span> </span>&#123;<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)living.size(); i++)	<span class="keyword">if</span> (ant[living[i]].steal_cake())	<span class="keyword">return</span> <span class="literal">true</span>;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">per_second</span><span class="params">(<span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (num &lt; <span class="number">6</span> &amp;&amp; !is_taken[<span class="number">0</span>][<span class="number">0</span>])	ant[cnt].birth(cnt), cnt++;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)living.size(); i++)	ant[living[i]].left_information();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)living.size(); i++)	ant[living[i]].move();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)living.size(); i++)	ant[living[i]].take_cake();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s; i++)	laser[i].attack();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, cur; i &lt; (<span class="keyword">int</span>)living.size(); i++) &#123;cur = living[i];	<span class="keyword">if</span> (ant[cur].cur_blood &lt; <span class="number">0</span>)	ant[cur].dead(), i--;&#125;</span><br><span class="line">	<span class="keyword">if</span> (game_over()) &#123;<span class="built_in">printf</span>(<span class="string">"Game over after %d seconds\n"</span>, t), lose = <span class="literal">true</span>;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</span><br><span class="line">	add_age(), lose_information();	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, num);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, cur = living[i]; i &lt; (<span class="keyword">int</span>)living.size(); cur = living[++i])</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d %d %d %d %d\n"</span>, ant[cur].age, ant[cur].level, ant[cur].cur_blood, ant[cur].x, ant[cur].y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d"</span>, &amp;n, &amp;m, &amp;s, &amp;d, &amp;r);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x, y; i &lt; s; i++)	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y), laser[i].build(x, y);</span><br><span class="line">	<span class="keyword">int</span> t;	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;t);	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t; i++)	<span class="keyword">if</span> (!per_second(i))	<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">if</span> (!lose)	<span class="built_in">printf</span>(<span class="string">"The game is going on\n"</span>);	output();	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://azrael.top/BZOJ4325【NOIp2015】斗地主 搜索+贪心/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Azrael_Death">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/BZOJ4325【NOIp2015】斗地主 搜索+贪心/" itemprop="url">BZOJ4325【NOIp2015】斗地主 <搜索+贪心></a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-25T00:00:00+08:00">
                2017-10-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,138
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  5
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="斗地主"><a href="#斗地主" class="headerlink" title="斗地主"></a>斗地主</h2><p> Time Limit: $30 Sec$  Memory Limit: $1024 MB$</p>
</blockquote>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>牛牛最近迷上了一种叫斗地主的扑克游戏。斗地主是一种使用黑桃、红心、梅花、方片的$A$到$K$加上大小王的共$54$张牌来进行的扑克牌游戏。在斗地主中，牌的大小关系根据牌的数码表示如下：$3&lt;4&lt;5&lt;6&lt;7&lt;8&lt;9&lt;10&lt;J&lt;Q&lt;K&lt;A&lt;2&lt;小王&lt;大王$，而花色并不对牌的大小产生影响。每一局游戏中，一副手牌由$n$张牌组成。游戏者每次可以根据规定的牌型进行出牌，首先打光自己的手牌一方取得游戏的胜利。现在，牛牛只想知道，对于自己的若干组手牌，分别最少需要多少次出牌可以将它们打光。请你帮他解决这个问题。需要注意的是，本题中游戏者每次可以出手的牌型与一般的斗地主相似而略有不同。具体规则如下：<br><img src="http://www.lydsy.com/JudgeOnline/upload/201511/11.PNG" alt=""></p>
<blockquote>
</blockquote>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>第一行包含用空格隔开的$2$个正整数$T,N$，表示手牌的组数以及每组手牌的张数。<br>接下来$T$组数据，每组数据$N$行，每行一个非负整数对$A_i,B_i$，表示一张牌，其中$A_i$表示牌的数码，$B_i$表示牌的花色，中间用空格隔开。特别的，我们用1来表示数码A，$11$表示数码$J$，$12$表示数码$Q$，$13$表示数码$K$；黑桃、红心、梅花、方片分别用$1\sim 4$来表示；小王的表示方法为$01$，大王的表示方法为$02$。</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>共$T$行，每行一个整数，表示打光第$T$组手牌的最少次数。</p>
<blockquote>
</blockquote>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1 8</span><br><span class="line">7 4</span><br><span class="line">8 4</span><br><span class="line">9 1</span><br><span class="line">10 4</span><br><span class="line">11 1</span><br><span class="line">5 1</span><br><span class="line">1 4</span><br><span class="line">1 1</span><br></pre></td></tr></table></figure>
<blockquote>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h3 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h3><p>共有$1$组手牌，包含$8$张牌：方片$7$，方片$8$，黑桃$9$，方片$10$，黑桃$J$，黑桃$5$，方片$A$以及黑桃$A$。可以通过打单顺子（方片$7$，方片$8$，黑桃$9$，方片$10$，黑桃$J$），单张牌（黑桃$5$）以及对子牌（黑桃$A$以及方片$A$）在$3$次内打光。<br>    $T\le 10$, $N\le 23$</p>
</blockquote>
<p>UOJ传送门：<a href="http://uoj.ac/problem/147" target="_blank" rel="noopener">http://uoj.ac/problem/147</a></p>
<p>标签:爆搜+贪心</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>题面看起来挺吓人，做起来却比较容易，特别是代码复杂度不高（毕竟做了恶心的猪国杀作铺垫）。<br>发现确定顺子之后，其他所有牌都可以贪心取，从耗费牌数多的往牌数少的取。<br>用一个$DFS$作大框架，在$DFS$到每一层（即每次取一组顺子）的前后用贪心算出当前不再取顺子而直接贪心取的总次数，打擂即可。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>（貌似这个代码只能过原数据，加强版因为“有几个相同的王不能组成对子”这一$bug$，我的代码过不了，要加特判）<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIZE 14</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n, ans, c[SIZE];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;ans = INF;	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SIZE; i++)	c[i] = <span class="number">0</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>&#123;<span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i++)	c[i] += x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> c1, c2, c3, c4, ret;	c1 = c2 = c3 = c4 = ret = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SIZE; i++)	c1 += (c[i] == <span class="number">1</span>), c2 += (c[i] == <span class="number">2</span>), c3 += (c[i] == <span class="number">3</span>), c4 += (c[i] == <span class="number">4</span>);</span><br><span class="line">	<span class="keyword">while</span> (c2 &gt;= <span class="number">2</span> &amp;&amp; c4 &gt;= <span class="number">1</span>)	c2 -= <span class="number">2</span>, c4 -= <span class="number">1</span>, ret++;	<span class="keyword">while</span> (c2 &gt;= <span class="number">1</span> &amp;&amp; c3 &gt;= <span class="number">1</span>)	c2 -= <span class="number">1</span>, c3 -= <span class="number">1</span>, ret++;</span><br><span class="line">	<span class="keyword">while</span> (c1 &gt;= <span class="number">2</span> &amp;&amp; c4 &gt;= <span class="number">1</span>)	c1 -= <span class="number">2</span>, c4 -= <span class="number">1</span>, ret++;	<span class="keyword">while</span> (c2 &gt;= <span class="number">1</span> &amp;&amp; c4 &gt;= <span class="number">1</span>)	c2 -= <span class="number">1</span>, c4 -= <span class="number">1</span>, ret++;</span><br><span class="line">	<span class="keyword">while</span> (c1 &gt;= <span class="number">1</span> &amp;&amp; c3 &gt;= <span class="number">1</span>)	c1 -= <span class="number">1</span>, c3 -= <span class="number">1</span>, ret++;	<span class="keyword">return</span> ret+c1+c2+c3+c4;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> stp)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> lft = calc();	<span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">if</span> (stp &gt; ans)	<span class="keyword">return</span>;	ans = min(ans, stp+lft);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>; l+<span class="number">1</span> &lt; SIZE; l++) &#123;</span><br><span class="line">		<span class="keyword">int</span> tr = l;	<span class="keyword">while</span> (c[tr] &gt;= <span class="number">3</span> &amp;&amp; tr &lt; SIZE)	tr++;</span><br><span class="line">		<span class="keyword">if</span> (--tr-l+<span class="number">1</span> &lt; <span class="number">2</span>)	<span class="keyword">continue</span>;	flag = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> r = tr; r &gt;= l+<span class="number">1</span>; r--)	modify(l, r, <span class="number">-3</span>), DFS(stp+<span class="number">1</span>), modify(l, r, <span class="number">3</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>; l+<span class="number">2</span> &lt; SIZE; l++) &#123;</span><br><span class="line">		<span class="keyword">int</span> tr = l; <span class="keyword">while</span> (c[tr] &gt;= <span class="number">2</span> &amp;&amp; tr &lt; SIZE)	tr++;</span><br><span class="line">		<span class="keyword">if</span> (--tr-l+<span class="number">1</span> &lt; <span class="number">3</span>)	<span class="keyword">continue</span>;	flag = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> r = tr; r &gt;= l+<span class="number">2</span>; r--)	modify(l, r, <span class="number">-2</span>), DFS(stp+<span class="number">1</span>), modify(l, r, <span class="number">2</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>; l+<span class="number">4</span> &lt; SIZE; l++) &#123;</span><br><span class="line">		<span class="keyword">int</span> tr = l;	<span class="keyword">while</span> (c[tr] &gt;= <span class="number">1</span> &amp;&amp; tr &lt; SIZE)	tr++;</span><br><span class="line">		<span class="keyword">if</span> (--tr-l+<span class="number">1</span> &lt; <span class="number">5</span>)	<span class="keyword">continue</span>;	flag = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> r = tr; r &gt;= l+<span class="number">4</span>; r--)	modify(l, r, <span class="number">-1</span>), DFS(stp+<span class="number">1</span>), modify(l, r, <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	lft = calc(), ans = min(ans, stp+lft);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> T;	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;T, &amp;n);</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		init();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, a, b; i &lt; n; i++)	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b), a = a == <span class="number">1</span> ? <span class="number">13</span> : (a == <span class="number">0</span> ? <span class="number">0</span> : a<span class="number">-1</span>), c[a]++;</span><br><span class="line">		DFS(<span class="number">0</span>), <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://azrael.top/POJ2728 Desert King 二分+MST/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Azrael_Death">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/POJ2728 Desert King 二分+MST/" itemprop="url">POJ728 Desert King <二分+MST></a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-24T00:00:00+08:00">
                2017-10-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  954
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  5
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><h3 id="Desert-King"><a href="#Desert-King" class="headerlink" title="Desert King"></a>Desert King</h3><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>David the Great has just become the king of a desert country. To win the respect of his people, he decided to build channels all over his country to bring water to every village. Villages which are connected to his capital village will be watered. As the dominate ruler and the symbol of wisdom in the country, he needs to build the channels in a most elegant way.<br>After days of study, he finally figured his plan out. He wanted the average cost of each mile of the channels to be minimized. In other words, the ratio of the overall cost of the channels to the total length must be minimized. He just needs to build the necessary channels to bring water to all the villages, which means there will be only one way to connect each village to the capital.<br>His engineers surveyed the country and recorded the position and altitude of each village. All the channels must go straight between two villages and be built horizontally. Since every two villages are at different altitudes, they concluded that each channel between two villages needed a vertical water lifter, which can lift water up or let water flow down. The length of the channel is the horizontal distance between the two villages. The cost of the channel is the height of the lifter. You should notice that each village is at a different altitude, and different channels can’t share a lifter. Channels can intersect safely and no three villages are on the same line.<br>As King David’s prime scientist and programmer, you are asked to find out the best solution to build the channels.</p>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>There are several test cases. Each test case starts with a line containing a number $N (2 \le N \le 1000)$, which is the number of villages. Each of the following $N$ lines contains three integers, $x$, $y$ and $z$ $(0\le x, y &lt; 10^4, 0 \le z &lt; 10^7)$. $(x, y)$ is the position of the village and $z$ is the altitude. The first village is the capital. A test case with $N = 0$ ends the input, and should not be processed. </p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>For each test case, output one line containing a decimal number, which is the minimum ratio of overall cost of the channels to the total length. This number should be rounded three digits after the decimal point.<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/POJ2728 Desert King 二分+MST/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://azrael.top/POJ3228 Gold Transportation MST/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Azrael_Death">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/POJ3228 Gold Transportation MST/" itemprop="url">POJ3228 Gold Transportation <MST></a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-24T00:00:00+08:00">
                2017-10-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  730
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><h3 id="Gold-Transportation"><a href="#Gold-Transportation" class="headerlink" title="Gold Transportation"></a>Gold Transportation</h3><p>Time Limit: $2000MS$<br>Memory Limit: $65536K$</p>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>Recently, a number of gold mines have been discovered in Zorroming State. To protect this treasure, we must transport this gold to the storehouses as quickly as possible. Suppose that the Zorroming State consists of N towns and there are M bidirectional roads among these towns. The gold mines are only discovered in parts of the towns, while the storehouses are also owned by parts of the towns. The storage of the gold mine and storehouse for each town is finite. The truck drivers in the Zorroming State are famous for their bad temper that they would not like to drive all the time and they need a bar and an inn available in the trip for a good rest. Therefore, your task is to minimize the maximum adjacent distance among all the possible transport routes on the condition that all the gold is safely transported to the storehouses. </p>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>The input contains several test cases. For each case, the first line is integer $N$$(1\le N\le 200)$. The second line is $N$ integers associated with the storage of the gold mine in every towns .The third line is also $N$ integers associated with the storage of the storehouses in every towns .Next is integer $M$$(0\le M\le \frac{(n-1)\times n}{2})$.Then M lines follow. Each line is three integers $x$, $y$ and $d$$(1\le x,y\le N, 0&lt;d\le 10^4)$, means that there is a road between $x$ and $y$ for distance of $d$. $N=0$ means end of the input.</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>For each case, output the minimum of the maximum adjacent distance on the condition that all the gold has been transported to the storehouses or “No Solution”.<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/POJ3228 Gold Transportation MST/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://azrael.top/BZOJ1821【JSOI2010】Group部落划分 MST/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Azrael_Death">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/BZOJ1821【JSOI2010】Group部落划分 MST/" itemprop="url">BZOJ1821【JSOI2010】Group部落划分 <MST></a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-24T00:00:00+08:00">
                2017-10-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  787
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="【JSOI2010】Group-部落划分-Group"><a href="#【JSOI2010】Group-部落划分-Group" class="headerlink" title="【JSOI2010】Group 部落划分 Group"></a>【JSOI2010】Group 部落划分 Group</h2><p> Time Limit: $10 Sec$  Memory Limit: $64 MB$</p>
</blockquote>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>聪聪研究发现，荒岛野人总是过着群居的生活，但是，并不是整个荒岛上的所有野人都属于同一个部落，野人们总是拉帮结派形成属于自己的部落，不同的部落之间则经常发生争斗。只是，这一切都成为谜团了——聪聪根本就不知道部落究竟是如何分布的。 不过好消息是，聪聪得到了一份荒岛的地图。地图上标注了$N$个野人居住的地点（可以看作是平面上的坐标）。我们知道，同一个部落的野人总是生活在附近。我们把两个部落的距离，定义为部落中距离最近的那两个居住点的距离。聪聪还获得了一个有意义的信息——这些野人总共被分为了$K$个部落！这真是个好消息。聪聪希望从这些信息里挖掘出所有部落的详细信息。他正在尝试这样一种算法： 对于任意一种部落划分的方法，都能够求出两个部落之间的距离，聪聪希望求出一种部落划分的方法，使靠得最近的两个部落尽可能远离。 例如，下面的左图表示了一个好的划分，而右图则不是。请你编程帮助聪聪解决这个难题。 </p>
<p><img src="http://www.lydsy.com/JudgeOnline/images/1821.jpg" alt=""></p>
<blockquote>
</blockquote>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>第一行包含两个整数$N$和$K$($1\le N\le 1000$,$1&lt; K\le N$)，分别代表了野人居住点的数量和部落的数量。<br>接下来$N$行，每行包含两个正整数$x,y$，描述了一个居住点的坐标($0\le x, y\le10000$)</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>输出一行，为最优划分时，最近的两个部落的距离，精确到小数点后两位。</p>
<blockquote>
</blockquote>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">4 2</span><br><span class="line">0 0</span><br><span class="line">0 1</span><br><span class="line">1 1</span><br><span class="line">1 0</span><br></pre></td></tr></table></figure>
<blockquote>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.00</span><br></pre></td></tr></table></figure>
</blockquote>
<p>标签：$MST$</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>此题是$MST$的一个简单变形。<br>本题要求分为$k$个部落，即在生成树上拆$k-1$条边。<br>使得其最小距离最大，可以$kruskal$贪心向下选，选到剩$k-1$条边为止。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 1000</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> dnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> u, v;	dnt c;&#125; E[MAX_N*MAX_N+<span class="number">50</span>];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span> <span class="params">(<span class="keyword">const</span> node &amp;a, <span class="keyword">const</span> node &amp;b)</span> </span>&#123;<span class="keyword">return</span> a.c &lt; b.c;&#125;</span><br><span class="line"><span class="keyword">int</span> n, k, cnt, x[MAX_N+<span class="number">5</span>], y[MAX_N+<span class="number">5</span>], fa[MAX_N+<span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	fa[i] = i;&#125;</span><br><span class="line"><span class="function">dnt <span class="title">dist</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;<span class="keyword">return</span> (dnt)<span class="built_in">sqrt</span>((x[a]-x[b])*(x[a]-x[b])+(y[a]-y[b])*(y[a]-y[b]));&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> c)</span> </span>&#123;<span class="keyword">return</span> fa[c] == c ? c : fa[c] = getf(fa[c]);&#125;</span><br><span class="line"><span class="function">dnt <span class="title">Kruskal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	sort(E, E+cnt, cmp);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, tot = <span class="number">0</span>; i &lt; cnt; i++) &#123;</span><br><span class="line">		<span class="keyword">int</span> u = getf(E[i].u), v = getf(E[i].v);</span><br><span class="line">		<span class="keyword">if</span> (u != v)	fa[u] = v, tot++;</span><br><span class="line">		<span class="keyword">if</span> (tot &gt; n-k)	<span class="keyword">return</span> E[i].c;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k), init();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x[i], &amp;y[i]);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt;= n; j++)	E[cnt++] = (node)&#123;i, j, dist(i, j)&#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%.2lf"</span>, Kruskal());</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://azrael.top/BZOJ3993【SDOI2015】星际战争 二分+最大流/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Azrael_Death">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/BZOJ3993【SDOI2015】星际战争 二分+最大流/" itemprop="url">BZOJ3993【SDOI2015】星际战争 <二分+网络流></a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-24T00:00:00+08:00">
                2017-10-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,393
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="【SDOI2015】星际战争"><a href="#【SDOI2015】星际战争" class="headerlink" title="【SDOI2015】星际战争"></a>【SDOI2015】星际战争</h2><p> Time Limit: $10 Sec$  Memory Limit: $128 MBSec$  $Special Judge$</p>
</blockquote>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>$3333$年，在银河系的某星球上，$X$军团和$Y$军团正在激烈地作战。在战斗的某一阶段，$Y$军团一共派遣了$N$个巨型机器人进攻$X$军团的阵地，其中第$i$个巨型机器人的装甲值为$A_i$。当一个巨型机器人的装甲值减少到$0$或者以下时，这个巨型机器人就被摧毁了。$X$军团有$M$个激光武器，其中第i个激光武器每秒可以削减一个巨型机器人$B_i$的装甲值。激光武器的攻击是连续的。这种激光武器非常奇怪，一个激光武器只能攻击一些特定的敌人。$Y$军团看到自己的巨型机器人被$X$军团一个一个消灭，他们急需下达更多的指令。为了这个目标，$Y$军团需要知道$X$军团最少需要用多长时间才能将$Y$军团的所有巨型机器人摧毁。但是他们不会计算这个问题，因此向你求助。</p>
<blockquote>
</blockquote>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>第一行，两个整数，$N$、$M$。<br>第二行，$N$个整数，$A_1$、$A_2$ $\cdots$ $A_N$。<br>第三行，$M$个整数，$B_1$、$B_2$ $\cdots$ $B_M$。<br>接下来的$M$行，每行$N$个整数，这些整数均为$0$或者$1$。这部分中的第$i$行的第$j$个整数为$0$表示第$i$个激光武器不可以攻击第$j$个巨型机器人，为$1$表示第$i$个激光武器可以攻击第$j$个巨型机器人。</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>一行，一个实数，表示$X$军团要摧毁$Y$军团的所有巨型机器人最少需要的时间。输出结果与标准答案的绝对误差不超过$10^{-3}$即视为正确。</p>
<blockquote>
</blockquote>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2 2</span><br><span class="line">3 10</span><br><span class="line">4 6</span><br><span class="line">0 1</span><br><span class="line">1 1</span><br></pre></td></tr></table></figure>
<blockquote>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.300000</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h3 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h3><p>【样例说明】<br>战斗开始后的前$0.5$秒，激光武器$1$攻击$2$号巨型机器人，激光武器$2$攻击$1$号巨型机器人。$1$号巨型机器人被完全摧毁，$2$号巨型机器人还剩余$8$的装甲值；<br>接下来的$0.8$秒，激光武器$1$、$2$同时攻击$2$号巨型机器人。$2$号巨型机器人被完全摧毁。<br>于全部的数据，$1\le N,M\le 50$，$1\le A_i\le 10^5$，$1\le B_i\le 10^3$，输入数据保证$X$军团一定能摧毁$Y$军团的所有巨型机器人</p>
</blockquote>
<p>标签：二分答案+网络流</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>如果直接处理这个问题，会发现限制有点多，不太好处理。<br>考虑二分答案。二分最少时间，那么每个激光炮在此时间内可造成的伤害就可以算出，这时只需判断合理分配这些伤害能否使敌方团灭。<br>发现可以建图跑最大流判断。从源点$S$向所有激光炮连边，容量为此激光炮可造成的总伤害。从所有机器人向汇点$T$连边，容量为机器人血量。从每个激光炮向其所可以造成伤害的所有机器人连边，容量为$\infty$，这样跑一遍最大流，判断是否等于所有机器人的总血量即可。<br>建图可以不用全部新建，只用在开始的时候建一个图，二分判断时将所有$S$到激光炮的边容量改成$B_i\times tans$即可。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EPS 1e-8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid (l+r)/2</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> dnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> v, nxt; dnt c;&#125; E[MAX_N*MAX_N*<span class="number">5</span>+<span class="number">500</span>];	dnt sum;</span><br><span class="line"><span class="keyword">int</span> n, m, s, t, a[MAX_N+<span class="number">5</span>], b[MAX_N+<span class="number">5</span>], mrk[MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>], pre[MAX_N+<span class="number">5</span>], d[MAX_N+<span class="number">5</span>], cnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;<span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pre)), cnt = <span class="number">0</span>, s = <span class="number">0</span>, t = n+m+<span class="number">1</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, dnt c)</span> </span>&#123;E[cnt].v = v, E[cnt].c = c, E[cnt].nxt = pre[u], pre[u] = cnt++;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	init();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	insert(i, t, a[i]), insert(t, i, <span class="number">0</span>), sum += a[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	insert(s, i+n, INF), insert(i+n, s, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)	<span class="keyword">if</span> (mrk[i][j])	insert(i+n, j, INF), insert(j, i+n, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;	<span class="built_in">memset</span>(d, <span class="number">-1</span>, <span class="keyword">sizeof</span>(d));	que.push(s), d[s] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (!que.empty()) &#123;</span><br><span class="line">		<span class="keyword">int</span> u = que.front();	que.pop();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; ~i; i = E[i].nxt) &#123;</span><br><span class="line">			<span class="keyword">int</span> v = E[i].v;	<span class="keyword">if</span> (E[i].c &lt;= EPS || ~d[v])	<span class="keyword">continue</span>;</span><br><span class="line">			d[v] = d[u]+<span class="number">1</span>;	que.push(v);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ~d[t];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">dnt <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u, dnt flow)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (u == t)	<span class="keyword">return</span> flow;	dnt ret = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; ~i; i = E[i].nxt) &#123;</span><br><span class="line">		<span class="keyword">int</span> v = E[i].v;	<span class="keyword">if</span> (E[i].c &lt;= EPS || d[v] != d[u]+<span class="number">1</span>)	<span class="keyword">continue</span>;</span><br><span class="line">		dnt tmp = DFS(v, min(flow, E[i].c));</span><br><span class="line">		E[i].c -= tmp, E[i^<span class="number">1</span>].c += tmp, ret += tmp, flow -= tmp;</span><br><span class="line">		<span class="keyword">if</span> (!flow)	<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (!ret)	d[u] = <span class="number">-1</span>;	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(dnt tans)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i += <span class="number">2</span>)	E[i].c += E[i^<span class="number">1</span>].c, E[i^<span class="number">1</span>].c = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[s]; ~i; i = E[i].nxt)	E[i].c = (dnt)b[E[i].v-n]*tans;</span><br><span class="line">	dnt tot = <span class="number">0</span>;	<span class="keyword">while</span> (BFS())	tot += DFS(s, INF);	<span class="keyword">return</span> <span class="built_in">fabs</span>(tot-sum) &lt;= EPS;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">dnt <span class="title">bi_search</span><span class="params">(dnt l, dnt r)</span> </span>&#123;</span><br><span class="line">	dnt ret = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">		<span class="keyword">if</span> (chk(mid))	ret = r = mid;</span><br><span class="line">		<span class="keyword">else</span>	l = mid;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, a+i);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, b+i);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mrk[i][j]);</span><br><span class="line">	build(), <span class="built_in">printf</span>(<span class="string">"%.5lf"</span>, bi_search(<span class="number">0</span>, INF));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://azrael.top/BZOJ1972【SDOI2010】猪国杀/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Azrael_Death">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/BZOJ1972【SDOI2010】猪国杀/" itemprop="url">BZOJ1972 【SDOI2010】 猪国杀 <模拟></a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-17T00:00:00+08:00">
                2017-10-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6,336
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  31
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="【SDOI2010】猪国杀"><a href="#【SDOI2010】猪国杀" class="headerlink" title="【SDOI2010】猪国杀"></a>【SDOI2010】猪国杀</h2><p> Time Limit: $1 Sec$  Memory Limit: $64 MB$</p>
</blockquote>
<h3 id="题目描述-Description"><a href="#题目描述-Description" class="headerlink" title="题目描述 Description"></a>题目描述 Description</h3><ol>
<li>概述<pre><code>《猪国杀》是一种多猪牌类回合制游戏，一共有三种角色：主猪，忠猪，反猪。
每局游戏主猪有且只有一只，忠猪和反猪可以有多只，每只猪扮演一种角色。
</code></pre></li>
<li>游戏目的：<pre><code>·主猪（$MP$）：自己存活的情况下消灭所有的反猪。
·忠猪（ZP）：不惜一切保护主猪，胜利条件与主猪相同。
·反猪（FP）：杀死主猪。
</code></pre></li>
<li>游戏过程：<pre><code>·游戏开始时候，每个玩家手里都会有$4$张牌，且体力上限和初始体力都是$4$。
·开始游戏时，从主猪开始，按照逆时针方向（数据中就是按照编号从1,2,3..n,1..的顺序）依次行动。
·每个玩家自己的回合可以分为2个阶段：
·摸牌阶段：
    ·从牌堆顶部摸两张牌，依次放到手牌的最右边。
·出牌阶段：
    ·你可以使用0张到任意张牌，每次使用牌的时候都使用最靠左的能够使用的牌。
    ·当然，要满足如下规则：
        ·1.如果没有猪哥连弩，每个出牌阶段只能使用一次“杀”来攻击。
        ·2.任何牌被使用后被弃置（武器是装备上）。
        ·被弃置的牌以后都不能再用，即与游戏无关。
</code></pre></li>
<li>各种牌介绍：<pre><code>·每张手牌用一个字母表示，字母代表牌的种类。
·基本牌：
    『桃(P)』：
        ·在自己的回合内，如果自己的体力值不等于体力上限，那么使用一个桃可以为自己补充一点体力，否则不能使用桃。
        ·桃只能对自己使用。
        ·在自己的回合外，如果自己的血变为0或者更低，那么也可以使用。
    『杀(K)』：
        ·在自己的回合内，对攻击范围内除自己以外的一名角色使用。
        ·如果没有被『闪』抵消，则造成1点伤害。无论有无武器，杀的攻击范围都是1。
    『闪(D)』：
        ·当你受到杀的攻击时，可以弃置一张闪来抵消杀的效果。
·锦囊牌：
    『决斗(F)』：
        ·出牌阶段，对除自己以外任意一名角色使用，由目标角色先开始，自己和目标角色轮流弃置一张杀，首先没有杀可弃的一方受到1点伤害，另一方视为此伤害的来源。
    『南猪入侵(N)』：
        ·出牌阶段，对除你以外所有角色使用，按逆时针顺序从使用者下家开始依次结算，除非弃置一张杀，否则受到1点伤害。
    『万箭齐发(W)』：
        ·和南猪入侵类似，不过要弃置的不是杀而是闪。
    『无懈可击(J)』：
        ·在目标锦囊生效前抵消其效果。
        ·每次有一张锦囊即将生效时，从使用这张锦囊的猪开始，按照逆时针顺序，依次得到使用无懈可击的机会。
        ·效果：
            ·用于决斗时，决斗无效并弃置。
            ·用于南猪入侵或万箭齐发时，当结算到某个角色时才能使用，当前角色不需弃置牌并且不会受到伤害（仅对一个角色产生效果）。
            ·用于无懈可击时，成为目标的无懈可击被无效。
·装备牌：
    『猪哥连弩(Z)』：
        ·武器，攻击范围1，出牌阶段你可以使用任意张杀。
    ·同一时刻最多只能装一个武器。
    ·如果先前已经有了一把武器，那么之后再装武器的话，会弃置以前的武器来装现在的武器。
</code></pre></li>
<li>特殊事件及概念解释：<pre><code>·伤害来源：
    ·杀、南猪入侵、万箭齐发的伤害来源均是使用该牌的猪。
    ·决斗的伤害来源如上。
·距离：
    ·两只猪的距离定义为沿着逆时针方向间隔的猪数＋1。即初始时1和2的距离为1，但是2和1的距离就是n-1。
    ·注意一个角色的死亡会导致一些猪距离的改变；
·玩家死亡：
    ·如果该玩家的体力降到0或者更低，并且自己手中没有足够的桃使得自己的体力值回到1，那么就死亡了。
    ·死亡后所有的牌（装备区，手牌区）被弃置。
·奖励与惩罚：
    ·反猪死亡时，最后一个伤害来源处（即使是反猪）立即摸三张牌。
    ·忠猪死亡时，如果最后一个伤害来源是主猪，那么主猪所有装备牌、手牌被弃置。
·注意，一旦达成胜利条件，游戏立刻结束，因此即使会摸3张牌或者还有牌可以用也不用执行了。
</code></pre></li>
<li>几种行为：<pre><code>·献殷勤：
    ·使用无懈可击挡下南猪入侵、万箭齐发、决斗。
    ·使用无懈可击抵消表敌意。
·表敌意：
    ·对某个角色使用杀、决斗。
    ·使用无懈可击抵消献殷勤。
·跳忠：
    ·即通过行动表示自己是忠猪。
    ·跳忠行动就是对主猪或对某只已经跳忠的猪献殷勤，或者对某只已经跳反的猪表敌意。
·跳反：
    ·即通过行动表示自己是反猪。
    ·跳反行动就是对主猪或对某只已经跳忠的猪表敌意，或者对某只已经跳反的猪献殷勤。
·忠猪不会跳反，反猪也不会跳忠。
·不管是忠猪还是反猪，能够跳必然跳。
</code></pre></li>
<li>行动准则：<pre><code>·共性：
    ·每个角色如果手里有桃且生命值未满，那么必然吃掉。
    ·有南猪入侵、万箭齐发、必然使用。
    ·有装备必然装上。
    ·受到杀时，有闪必然弃置。
    ·响应南猪入侵或者万箭齐发时候，有杀/闪必然弃置。
    ·不会对未表明身份的猪献殷勤（包括自己）。
·特性：
    ·主猪：
        ·主猪会认为没有跳身份，且用南猪入侵/万箭齐发对自己造成伤害的猪是类反猪（没伤害到不算，注意类反猪并没有表明身份），如果之后跳了，那么主猪会重新认识这只猪。
        ·对于每种表敌意的方式，对逆时针方向能够执行到的第一只类反猪或者已跳反猪表；如果没有，那么就不表敌意。
        ·决斗时会不遗余力弃置杀。
        ·如果能对已经跳忠的猪或自己献殷勤，那么一定献。
        ·如果能够对已经跳反的猪表敌意，那么一定表。
    ·忠猪：
        ·对于每种表敌意的方式，对逆时针方向能够执行到的第一只已经跳反的猪表，如果没有，那么就不表敌意。
        ·决斗时，如果对方是主猪，那么不会弃置杀，否则，会不遗余力弃置杀。
        ·如果有机会对主猪或者已经跳忠的猪献殷勤，那么一定献。
    ·反猪：
        ·对于每种表敌意的方式，如果有机会则对主猪表，否则，对逆时针方向能够执行到的第一只已经跳忠的猪表，如果没有，那么就不表敌意。
        ·决斗时会不遗余力弃置杀。
        ·如果有机会对已经跳反的猪献殷勤，那么一定献。
</code></pre>现在，我们已经知道每只猪的角色、手牌，还有牌堆初始情况，并且假设每个角色会按照如下的行为准则进行游戏，你需要做的就是告诉小猪$iPig$最后的结果。<br>限于$iPig$只会用$P++$语言写$A+B$，他请你用$Pigcal(Pascal)$、$P(C)$或$P++(C++)$语言来帮他预测最后的结果。<blockquote>
</blockquote>
<h3 id="输入描述-Input-Description"><a href="#输入描述-Input-Description" class="headerlink" title="输入描述 Input Description"></a>输入描述 Input Description</h3>输入文件第一行包含两个正整数$n$($2\le n\le 10$)和$m$($m\le 2000$)，分别代表玩家数和牌堆中牌的数量。数据保证牌的数量够用。<br>接下来$n$行，每行$5$个字符串，依次表示对第$i$只猪的角色和初始$4$张手牌描述。编号为$1$的肯定是主猪。<br>再接下来一行，一共$m$个字符串，按照从牌堆顶部到牌堆底部的顺序描述每张牌。<br>所有的相邻的两个字符串都严格用$1$个空格隔开，行尾没有多余空格。<h3 id="输出描述-Output-Description"><a href="#输出描述-Output-Description" class="headerlink" title="输出描述 Output Description"></a>输出描述 Output Description</h3>输出数据第一行包含一个字符串代表游戏结果。如果是主猪胜利，那么输出$MP$，否则输出$FP$。数据保证游戏总会结束。<br>接下来$n$行，第$i$行是对第$i$只猪的手牌描述（注意只需要输出手牌），按照手牌从左往右的顺序输出，相邻两张牌用一个空格隔开，行末尾没有多余空格。如果这只猪已阵亡，那么只要输出$DEAD$即可。注意如果要输出手牌而没有手牌的话，那么只需输出一个空行。<blockquote>
</blockquote>
<h3 id="样例数据-Sample-Data"><a href="#样例数据-Sample-Data" class="headerlink" title="样例数据 Sample Data"></a>样例数据 Sample Data</h3><blockquote>
<p><strong>Sample Input #1</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">3 10</span><br><span class="line">MP D D F F</span><br><span class="line">ZP N N N D</span><br><span class="line">FP J J J J</span><br><span class="line">F F D D J J F F K D</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ol>
<blockquote>
<p><strong>Sample Output #1</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FP</span><br><span class="line">DEAD</span><br><span class="line">DEAD</span><br><span class="line">J J J J J J D</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<h3 id="数据范围及提示-Data-Size-amp-Hint"><a href="#数据范围及提示-Data-Size-amp-Hint" class="headerlink" title="数据范围及提示 Data Size &amp; Hint"></a>数据范围及提示 Data Size &amp; Hint</h3><p>样例$1$说明：第一回合主猪没有目标可以表敌意；接下来忠猪使用了$3$张南猪入侵，主猪掉了$3$点体力，并认为该角色为类反猪，$3$号角色尽管手里有无懈可击，但是因为自己未表明身份，所以同样不能对自己用，乖乖掉$3$点体力；下一回合反猪无牌可出；接下来主猪对着类反猪爆发，使用$4$张决斗，忠猪死亡，结果主猪弃掉所有牌；下来反猪摸到一张杀直接杀死主猪获胜。<br>数据说明：一共$20$组测试数据，每个点$5$分。$10\%$的数据没有锦囊牌，另外$20\%$的数据没有无懈可击。</p>
</blockquote>
<p>如果觉得此题面不好看，请戳这里：<a href="https://mubu.com/doc/2707815814591da4" target="_blank" rel="noopener">https://mubu.com/doc/2707815814591da4</a></p>
<p>标签：模拟</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>本题是大模拟，题面很恶心，又长又绕，根本无法概括，不过读懂以后按序操作还是比较容易的。<br>坑点如下：</p>
<ol>
<li>如果牌堆中没牌了，那么需要不断的摸取最后一张牌</li>
<li>无懈可击的使用：可以用来帮助身份已明且和自己一伙的人抵挡南猪入侵、万箭齐发、决杀等效果，或者帮助其抵消对方无懈可击的效果。一旦使出无懈可击即可表明自己的身份，表明身份后类反猪的身份会随之消失。注意无懈可击的使用顺序是从锦囊牌的出牌者开始按照逆时针的顺序进行出牌的。</li>
<li>一只猪死亡后立刻退场，不会再进行任何操作，所有手牌弃置。如果此时游戏结束，那么一切操作都暂停。</li>
<li>出完一张牌后（除桃）需要重新扫描所有的手牌，因为每次出牌可能会导致不同的猪身份的改变，进而前面跳过的牌可能有机会打出。</li>
<li>寻找打出杀得下家时要跳过已经死亡的猪。</li>
<li>打出决斗，无论最后是否生效，即认为身份表面。对于主猪对忠猪发起的决斗，忠猪乖乖掉血。</li>
</ol>
<p>奉献几组样例，可以自测：</p>
<h5 id="Sample-1"><a href="#Sample-1" class="headerlink" title="Sample #1"></a>Sample #1</h5><p><strong>Input</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">3 10</span><br><span class="line">MP D D F F</span><br><span class="line">ZP N N N D</span><br><span class="line">FP J J J J</span><br><span class="line">F F D D J J F F K D</span><br></pre></td></tr></table></figure></p>
<p><strong>Output</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FP</span><br><span class="line">DEAD</span><br><span class="line">DEAD</span><br><span class="line">J J J J J J D</span><br></pre></td></tr></table></figure></p>
<h5 id="Sample-2"><a href="#Sample-2" class="headerlink" title="Sample #2"></a>Sample #2</h5><p><strong>Input</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">5 10</span><br><span class="line">MP W D F K</span><br><span class="line">ZP N N D D</span><br><span class="line">FP F W W K</span><br><span class="line">ZP K K N D</span><br><span class="line">FP K D P W</span><br><span class="line">J K W K D N N K J N</span><br></pre></td></tr></table></figure></p>
<p><strong>Output</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MP</span><br><span class="line">F N</span><br><span class="line">D</span><br><span class="line">DEAD</span><br><span class="line">DEAD</span><br></pre></td></tr></table></figure></p>
<h5 id="Sample-3"><a href="#Sample-3" class="headerlink" title="Sample #3"></a>Sample #3</h5><p><strong>Input</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">3 4</span><br><span class="line">MP J J K N</span><br><span class="line">ZP J D K W</span><br><span class="line">FP P N P K</span><br><span class="line">J J K W</span><br></pre></td></tr></table></figure></p>
<p><strong>Output</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MP</span><br><span class="line">K K</span><br><span class="line">DEAD</span><br></pre></td></tr></table></figure></p>
<h5 id="Sample-4"><a href="#Sample-4" class="headerlink" title="Sample #4"></a>Sample #4</h5><p><strong>Input</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">3 10</span><br><span class="line">MP W D J W</span><br><span class="line">ZP J P D N</span><br><span class="line">FP N D F F</span><br><span class="line">J D N N F J J D K W</span><br></pre></td></tr></table></figure></p>
<p><strong>Output</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MP</span><br><span class="line">D J D</span><br><span class="line">DEAD</span><br></pre></td></tr></table></figure></p>
<h5 id="Sample-5"><a href="#Sample-5" class="headerlink" title="Sample #5"></a>Sample #5</h5><p><strong>Input</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">3 1</span><br><span class="line">MP D N F K</span><br><span class="line">ZP F W F N</span><br><span class="line">FP D N N D</span><br><span class="line">K</span><br></pre></td></tr></table></figure></p>
<p><strong>Output</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MP</span><br><span class="line">K</span><br><span class="line">F K K</span><br><span class="line">DEAD</span><br></pre></td></tr></table></figure></p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>注释版<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 2000</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, Type[MAX_N+<span class="number">5</span>];	<span class="comment">//真实身份（1主公 2忠臣 3反贼）</span></span><br><span class="line"><span class="keyword">int</span> lft;	<span class="keyword">bool</span> GameOver;	<span class="comment">//剩余反贼、游戏结束标记</span></span><br><span class="line"><span class="keyword">char</span> Heap[MAX_M*<span class="number">2</span>+<span class="number">5</span>];	<span class="keyword">int</span> CurPos;	<span class="comment">//牌堆</span></span><br><span class="line"><span class="keyword">int</span> bef[MAX_M*<span class="number">5</span>+<span class="number">5</span>], nxt[MAX_M*<span class="number">5</span>+<span class="number">5</span>], cnt;	<span class="keyword">char</span> c[MAX_M*<span class="number">5</span>+<span class="number">5</span>];	<span class="comment">//手牌</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">Draw</span><span class="params">()</span> </span>&#123;CurPos = CurPos == m ? m : CurPos+<span class="number">1</span>;	<span class="keyword">return</span> Heap[CurPos];&#125;	<span class="comment">//摸牌</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Player</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> id, Sta;	<span class="comment">//编号、目前身份（0没跳 1类反 2跳忠 3跳反）</span></span><br><span class="line">	<span class="keyword">int</span> head, tail, now, tp;	<span class="comment">//手牌链表</span></span><br><span class="line">	<span class="keyword">int</span> cntWX, cntA, cntP, cntS;	<span class="comment">//手中无懈可击、杀、桃、闪的数量</span></span><br><span class="line">	<span class="keyword">int</span> blood, atk, pre, suc;	<span class="comment">//血量、首要攻击目标、存活的上一头猪、存活的下一头猪</span></span><br><span class="line">	<span class="keyword">bool</span> dead, equip;	<span class="comment">//是否死亡、是否装备连弩</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Bonus</span><span class="params">()</span> </span>&#123;	<span class="comment">//奖励</span></span><br><span class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</span><br><span class="line">		<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;</span><br><span class="line">		<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</span><br><span class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</span><br><span class="line">		nxt[tail] = cnt, tail = cnt;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</span><br><span class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</span><br><span class="line">		nxt[tail] = cnt, tail = cnt;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Punish</span><span class="params">()</span> </span>&#123;	<span class="comment">//惩罚</span></span><br><span class="line">		head = tail = now = cntWX = cntA = cntP = cntS = <span class="number">0</span>, equip = <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">DrawSession</span><span class="params">()</span> </span>&#123;	<span class="comment">//摸牌阶段</span></span><br><span class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</span><br><span class="line">		<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;</span><br><span class="line">		<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</span><br><span class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</span><br><span class="line">		nxt[tail] = cnt, tail = cnt;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Use</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;	<span class="comment">//使用一张牌</span></span><br><span class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'J'</span>)	cntWX--;</span><br><span class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'K'</span>)	cntA--;</span><br><span class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'P'</span>)	cntP--;</span><br><span class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'D'</span>)	cntS--;</span><br><span class="line">		<span class="keyword">if</span> (x == head &amp;&amp; x == tail)	head = tail = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == head)	head = nxt[x], bef[nxt[x]] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == tail)	tail = bef[x], nxt[bef[x]] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">else</span>	bef[nxt[x]] = bef[x], nxt[bef[x]] = nxt[x];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">char</span> <span class="title">GetNxt</span><span class="params">()</span> </span>&#123;	<span class="comment">//返回下一张牌</span></span><br><span class="line">		<span class="keyword">if</span> (!now)	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		tp = now, now = nxt[now];</span><br><span class="line">		<span class="keyword">return</span> c[tp];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findWX</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张无懈可击</span></span><br><span class="line">		now = head;	<span class="keyword">char</span> tmp;</span><br><span class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'J'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findA</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张杀</span></span><br><span class="line">		now = head;	<span class="keyword">char</span> tmp;</span><br><span class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'K'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findP</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张桃</span></span><br><span class="line">		now = head;	<span class="keyword">char</span> tmp;</span><br><span class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'P'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findS</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张闪</span></span><br><span class="line">		now = head;	<span class="keyword">char</span> tmp;</span><br><span class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'D'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryWX</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出无懈可击</span></span><br><span class="line">		<span class="keyword">if</span> (cntWX) &#123;Use(findWX());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryA</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出杀</span></span><br><span class="line">		<span class="keyword">if</span> (cntA) &#123;Use(findA());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryS</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出闪</span></span><br><span class="line">		<span class="keyword">if</span> (cntS) &#123;Use(findS());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryP</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出桃</span></span><br><span class="line">		<span class="keyword">if</span> (cntP) &#123;Use(findP());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Round</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		DrawSession();	now = head;</span><br><span class="line">		<span class="keyword">bool</span> atked = <span class="literal">false</span>;	<span class="keyword">char</span> tmp;</span><br><span class="line">		<span class="keyword">while</span> ((tmp = GetNxt()) &amp;&amp; !GameOver) &#123;</span><br><span class="line">			<span class="comment">//cout &lt;&lt; tmp &lt;&lt; " ";</span></span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'D'</span> || tmp == <span class="string">'J'</span>)	<span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'K'</span> &amp;&amp; atk == suc &amp;&amp; (!atked || equip)) &#123;</span><br><span class="line">				Use(tp), Attack(id, atk), now = head, atked = <span class="literal">true</span>;</span><br><span class="line">				<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'P'</span> &amp;&amp; blood != <span class="number">4</span>)	Use(tp), blood++;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'F'</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!atk)	<span class="keyword">continue</span>;</span><br><span class="line">				Use(tp);</span><br><span class="line">				<span class="keyword">if</span> (Type[id] == <span class="number">3</span>)	Duel(id, <span class="number">1</span>);</span><br><span class="line">				<span class="keyword">else</span>	Duel(id, atk);</span><br><span class="line">				now = head;</span><br><span class="line">				<span class="keyword">if</span> (GameOver || dead)	<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'N'</span>) &#123;</span><br><span class="line">				Use(tp), Invade(id), now = head;</span><br><span class="line">				<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'W'</span>) &#123;</span><br><span class="line">				Use(tp), Arrow(id), now = head;</span><br><span class="line">				<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'Z'</span>)	Use(tp), equip = <span class="literal">true</span>, now = head;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//cout &lt;&lt; endl;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (dead) &#123;<span class="built_in">printf</span>(<span class="string">"DEAD\n"</span>);	<span class="keyword">return</span>;&#125;</span><br><span class="line">		<span class="keyword">for</span> (; head; head = nxt[head])</span><br><span class="line">			<span class="keyword">if</span> (head == tail)	<span class="built_in">cout</span> &lt;&lt; c[head];</span><br><span class="line">			<span class="keyword">else</span>	<span class="built_in">cout</span> &lt;&lt; c[head] &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125; pig[MAX_N+<span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FindAtk</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> y = pig[x].suc;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span> (y != x) &#123;</span><br><span class="line">			<span class="keyword">if</span> (pig[y].Sta == <span class="number">1</span> || pig[y].Sta == <span class="number">3</span>) &#123;</span><br><span class="line">				pig[x].atk = y;	<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			y = pig[y].suc;</span><br><span class="line">		&#125;</span><br><span class="line">		pig[x].atk = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">2</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span> (y != x) &#123;</span><br><span class="line">			<span class="keyword">if</span> (pig[y].Sta == <span class="number">3</span>) &#123;</span><br><span class="line">				pig[x].atk = y;	<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			y = pig[y].suc;</span><br><span class="line">		&#125;</span><br><span class="line">		pig[x].atk = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">3</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span> (y != x) &#123;</span><br><span class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</span><br><span class="line">				pig[x].atk = y;	<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			y = pig[y].suc;</span><br><span class="line">		&#125;</span><br><span class="line">		pig[x].atk = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Maintain</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x = pig[<span class="number">1</span>].suc;	FindAtk(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">while</span> (x != <span class="number">1</span>)	FindAtk(x), x = pig[x].suc;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Kill</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//杀死对方</span></span><br><span class="line">	pig[y].dead = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">3</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (--lft == <span class="number">0</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;</span><br><span class="line">		pig[x].Bonus();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	pig[x].Punish();</span><br><span class="line">	<span class="keyword">int</span> PRE = pig[y].pre, SUC = pig[y].suc;</span><br><span class="line">	pig[PRE].suc = SUC, pig[SUC].pre = PRE;</span><br><span class="line">	Maintain();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hurt</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//命中对方</span></span><br><span class="line">	<span class="keyword">if</span> (--pig[y].blood == <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">if</span> (pig[y].tryP())	pig[y].blood++;</span><br><span class="line">		<span class="keyword">else</span>	Kill(x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//杀</span></span><br><span class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;</span><br><span class="line">		Maintain();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (!pig[y].tryS())	Hurt(x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">WXcycle</span><span class="params">(<span class="keyword">int</span> st, <span class="keyword">bool</span> YType)</span> </span>&#123;	<span class="comment">//无懈可击</span></span><br><span class="line">	<span class="keyword">int</span> last = st, x = st;	<span class="keyword">bool</span> ORI = YType;</span><br><span class="line">	<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX()) &#123;</span><br><span class="line">		last = x, YType ^= <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>)	pig[x].Sta = <span class="number">3</span>-YType, Maintain();</span><br><span class="line">	&#125;</span><br><span class="line">	x = pig[x].suc;</span><br><span class="line">	<span class="keyword">while</span> (x != last) &#123;</span><br><span class="line">		<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX()) &#123;</span><br><span class="line">			last = x, YType ^= <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>)	pig[x].Sta = <span class="number">3</span>-YType, Maintain();</span><br><span class="line">		&#125;</span><br><span class="line">		x = pig[x].suc;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ORI != YType;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//决斗</span></span><br><span class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;</span><br><span class="line">		Maintain();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</span><br><span class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>))	<span class="keyword">return</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>))	<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	Hurt(x, y);</span><br><span class="line">	<span class="keyword">else</span>	<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!pig[y].tryA()) &#123;Hurt(x, y);	<span class="keyword">return</span>;&#125;</span><br><span class="line">		<span class="keyword">if</span> (!pig[x].tryA()) &#123;Hurt(y, x);	<span class="keyword">return</span>;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;	<span class="comment">//南猪入侵</span></span><br><span class="line">	<span class="keyword">int</span> y = pig[x].suc;</span><br><span class="line">	<span class="keyword">while</span> (y != x) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</span><br><span class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">if</span> (!pig[y].tryA()) &#123;</span><br><span class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</span><br><span class="line">		&#125;</span><br><span class="line">		y = pig[y].suc;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;	<span class="comment">//万箭齐发</span></span><br><span class="line">	<span class="keyword">int</span> y = pig[x].suc;</span><br><span class="line">	<span class="keyword">while</span> (y != x) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</span><br><span class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">if</span> (!pig[y].tryS()) &#123;</span><br><span class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</span><br><span class="line">		&#125;</span><br><span class="line">		y = pig[y].suc;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);	<span class="keyword">char</span> s[<span class="number">2</span>];	<span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">1</span>; i--)	pig[i].pre = i<span class="number">-1</span>;	pig[<span class="number">1</span>].pre = n;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)	pig[i].suc = i+<span class="number">1</span>;	pig[n].suc = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'M'</span>)	Type[i] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'Z'</span>)	Type[i] = <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'F'</span>)	Type[i] = <span class="number">3</span>, lft++;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s), Heap[++tot] = s[<span class="number">0</span>];	m = tot;	Maintain();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].id = i, pig[i].blood = <span class="number">4</span>, pig[i].DrawSession(), pig[i].DrawSession();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> cur = <span class="number">1</span>; !GameOver; cur = pig[cur].suc)	pig[cur].Round();</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, pig[<span class="number">1</span>].dead ? <span class="string">"FP"</span> : <span class="string">"MP"</span>);	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].Output();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>压行版<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 2000</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, Type[MAX_N+<span class="number">5</span>], lft, CurPos, cnt;	<span class="keyword">bool</span> GameOver;</span><br><span class="line"><span class="keyword">char</span> Heap[MAX_M*<span class="number">2</span>+<span class="number">5</span>], c[MAX_M*<span class="number">5</span>+<span class="number">5</span>];	<span class="keyword">int</span> bef[MAX_M*<span class="number">5</span>+<span class="number">5</span>], nxt[MAX_M*<span class="number">5</span>+<span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">Draw</span><span class="params">()</span> </span>&#123;CurPos = CurPos == m ? m : CurPos+<span class="number">1</span>;	<span class="keyword">return</span> Heap[CurPos];&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Player</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> id, Sta, head, tail, now, tp, cntWX, cntA, cntP, cntS, blood, atk, pre, suc;	<span class="keyword">bool</span> dead, equip;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Bonus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;	<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</span><br><span class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	nxt[tail] = cnt, tail = cnt;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</span><br><span class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	nxt[tail] = cnt, tail = cnt;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Punish</span><span class="params">()</span> </span>&#123;head = tail = now = cntWX = cntA = cntP = cntS = <span class="number">0</span>, equip = <span class="literal">false</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">DrawSession</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;	<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</span><br><span class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	nxt[tail] = cnt, tail = cnt;</span><br><span class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Use</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'J'</span>)	cntWX--;	<span class="keyword">if</span> (c[x] == <span class="string">'K'</span>)	cntA--;	<span class="keyword">if</span> (c[x] == <span class="string">'P'</span>)	cntP--;	<span class="keyword">if</span> (c[x] == <span class="string">'D'</span>)	cntS--;</span><br><span class="line">		<span class="keyword">if</span> (x == head &amp;&amp; x == tail)	head = tail = <span class="number">0</span>;	<span class="keyword">else</span> <span class="keyword">if</span> (x == head)	head = nxt[x], bef[nxt[x]] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == tail)	tail = bef[x], nxt[bef[x]] = <span class="number">0</span>;	<span class="keyword">else</span>	bef[nxt[x]] = bef[x], nxt[bef[x]] = nxt[x];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">char</span> <span class="title">GetNxt</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (!now)	<span class="keyword">return</span> <span class="number">0</span>;	tp = now, now = nxt[now];	<span class="keyword">return</span> c[tp];&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findWX</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'J'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findA</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'K'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findP</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'P'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findS</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'D'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryWX</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntWX) &#123;Use(findWX());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryA</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntA) &#123;Use(findA());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryS</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntS) &#123;Use(findS());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryP</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntP) &#123;Use(findP());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Round</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		DrawSession();	now = head;</span><br><span class="line">		<span class="keyword">bool</span> atked = <span class="literal">false</span>;	<span class="keyword">char</span> tmp;</span><br><span class="line">		<span class="keyword">while</span> ((tmp = GetNxt()) &amp;&amp; !GameOver) &#123;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'D'</span> || tmp == <span class="string">'J'</span>)	<span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'K'</span> &amp;&amp; atk == suc &amp;&amp; (!atked || equip))</span><br><span class="line">				&#123;Use(tp), Attack(id, atk), now = head, atked = <span class="literal">true</span>;	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;&#125;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'P'</span> &amp;&amp; blood != <span class="number">4</span>)	Use(tp), blood++;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'F'</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!atk)	<span class="keyword">continue</span>;	Use(tp);</span><br><span class="line">				<span class="keyword">if</span> (Type[id] == <span class="number">3</span>)	Duel(id, <span class="number">1</span>);</span><br><span class="line">				<span class="keyword">else</span>	Duel(id, atk);	now = head;</span><br><span class="line">				<span class="keyword">if</span> (GameOver || dead)	<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'N'</span>) &#123;Use(tp), Invade(id), now = head;	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;&#125;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'W'</span>) &#123;Use(tp), Arrow(id), now = head;	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;&#125;</span><br><span class="line">			<span class="keyword">if</span> (tmp == <span class="string">'Z'</span>)	Use(tp), equip = <span class="literal">true</span>, now = head;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (dead) &#123;<span class="built_in">printf</span>(<span class="string">"DEAD\n"</span>);	<span class="keyword">return</span>;&#125;</span><br><span class="line">		<span class="keyword">for</span> (; head; head = nxt[head])</span><br><span class="line">			<span class="keyword">if</span> (head == tail)	<span class="built_in">cout</span> &lt;&lt; c[head];</span><br><span class="line">			<span class="keyword">else</span>	<span class="built_in">cout</span> &lt;&lt; c[head] &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125; pig[MAX_N+<span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FindAtk</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> y = pig[x].suc;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span> (y != x) &#123;<span class="keyword">if</span> (pig[y].Sta == <span class="number">1</span> || pig[y].Sta == <span class="number">3</span>) &#123;pig[x].atk = y;	<span class="keyword">return</span>;&#125;	y = pig[y].suc;&#125;</span><br><span class="line">		pig[x].atk = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">2</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span> (y != x) &#123;<span class="keyword">if</span> (pig[y].Sta == <span class="number">3</span>) &#123;pig[x].atk = y;	<span class="keyword">return</span>;&#125;	y = pig[y].suc;&#125;</span><br><span class="line">		pig[x].atk = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">3</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span> (y != x) &#123;<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;pig[x].atk = y;	<span class="keyword">return</span>;&#125;	y = pig[y].suc;&#125;</span><br><span class="line">		pig[x].atk = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Maintain</span><span class="params">()</span> </span>&#123;<span class="keyword">int</span> x = pig[<span class="number">1</span>].suc;	FindAtk(<span class="number">1</span>);	<span class="keyword">while</span> (x != <span class="number">1</span>)	FindAtk(x), x = pig[x].suc;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Kill</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">	pig[y].dead = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">3</span>) &#123;<span class="keyword">if</span> (--lft == <span class="number">0</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;	pig[x].Bonus();&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	pig[x].Punish();</span><br><span class="line">	<span class="keyword">int</span> PRE = pig[y].pre, SUC = pig[y].suc;	pig[PRE].suc = SUC, pig[SUC].pre = PRE;	Maintain();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hurt</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;<span class="keyword">if</span> (--pig[y].blood == <span class="number">0</span>)	<span class="keyword">if</span> (pig[y].tryP())	pig[y].blood++;	<span class="keyword">else</span>	Kill(x, y);&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;</span><br><span class="line">		Maintain();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (!pig[y].tryS())	Hurt(x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">WXcycle</span><span class="params">(<span class="keyword">int</span> st, <span class="keyword">bool</span> YType)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> last = st, x = st;	<span class="keyword">bool</span> ORI = YType;</span><br><span class="line">	<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX()) &#123;last = x, YType ^= <span class="number">1</span>; <span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>) pig[x].Sta = <span class="number">3</span>-YType, Maintain();&#125;</span><br><span class="line">	x = pig[x].suc;</span><br><span class="line">	<span class="keyword">while</span> (x != last) &#123;</span><br><span class="line">		<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX())</span><br><span class="line">			&#123;last = x, YType ^= <span class="number">1</span>;	<span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>)	pig[x].Sta = <span class="number">3</span>-YType, Maintain();&#125;</span><br><span class="line">		x = pig[x].suc;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ORI != YType;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;	<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;	Maintain();&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</span><br><span class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>))	<span class="keyword">return</span>;&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>))	<span class="keyword">return</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	Hurt(x, y);</span><br><span class="line">	<span class="keyword">else</span>	<span class="keyword">for</span> (;;) &#123;<span class="keyword">if</span> (!pig[y].tryA()) &#123;Hurt(x, y);	<span class="keyword">return</span>;&#125;	<span class="keyword">if</span> (!pig[x].tryA()) &#123;Hurt(y, x);	<span class="keyword">return</span>;&#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> y = pig[x].suc;</span><br><span class="line">	<span class="keyword">while</span> (y != x) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</span><br><span class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</span><br><span class="line">		<span class="keyword">if</span> (!pig[y].tryA()) &#123;</span><br><span class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</span><br><span class="line">		&#125;</span><br><span class="line">		y = pig[y].suc;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> y = pig[x].suc;</span><br><span class="line">	<span class="keyword">while</span> (y != x) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</span><br><span class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</span><br><span class="line">		<span class="keyword">if</span> (!pig[y].tryS()) &#123;</span><br><span class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</span><br><span class="line">		&#125;</span><br><span class="line">		y = pig[y].suc;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);	<span class="keyword">char</span> s[<span class="number">2</span>];	<span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">1</span>; i--)	pig[i].pre = i<span class="number">-1</span>;	pig[<span class="number">1</span>].pre = n;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)	pig[i].suc = i+<span class="number">1</span>;	pig[n].suc = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'M'</span>)	Type[i] = <span class="number">1</span>;	<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'Z'</span>)	Type[i] = <span class="number">2</span>;	<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'F'</span>)	Type[i] = <span class="number">3</span>, lft++;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s), Heap[++tot] = s[<span class="number">0</span>];	m = tot;	Maintain();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].id = i, pig[i].blood = <span class="number">4</span>, pig[i].DrawSession(), pig[i].DrawSession();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> cur = <span class="number">1</span>; !GameOver; cur = pig[cur].suc)	pig[cur].Round();</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, pig[<span class="number">1</span>].dead ? <span class="string">"FP"</span> : <span class="string">"MP"</span>);	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].Output();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://azrael.top/BZOJ1070【SCOI2007】修车 费用流/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Azrael_Death">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/BZOJ1070【SCOI2007】修车 费用流/" itemprop="url">BZOJ1070【SCOI2007】修车 <费用流></a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-17T00:00:00+08:00">
                2017-10-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  803
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="【SCOI2007】修车"><a href="#【SCOI2007】修车" class="headerlink" title="【SCOI2007】修车"></a>【SCOI2007】修车</h2><p> Time Limit: $1 Sec$    Memory Limit: $128 MB$</p>
</blockquote>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>同一时刻有$N$位车主带着他们的爱车来到了汽车维修中心。维修中心共有$M$位技术人员，不同的技术人员对不同的车进行维修所用的时间是不同的。现在需要安排这$M$位技术人员所维修的车及顺序，使得顾客平均等待的时间最小。<br>说明：顾客的等待时间是指从他把车送至维修中心到维修完毕所用的时间。</p>
<blockquote>
</blockquote>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>第一行有两个$m,n$，表示技术人员数与顾客数。 接下来$n$行，每行$m$个整数。第$i+1$行第$j$个数表示第$j$位技术人<br>员维修第$i$辆车需要用的时间$T$。</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>最小平均等待时间，答案精确到小数点后$2$位。</p>
<blockquote>
</blockquote>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2 2</span><br><span class="line">3 2</span><br><span class="line">1 4</span><br></pre></td></tr></table></figure>
<blockquote>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.50</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h3 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h3><p> 据范围: $2\le M\le 9$, $1\le N\le 60$, $1\le T\le 1000$</p>
</blockquote>
<p>标签：费用流</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>此题建模是费用流中常见的拆点建模。<br>把每个技术人员拆成$n$个点，第$k$个点代表着此工作人员修的倒数第$k$辆车对答案的贡献。<br>对于每个顾客，如果他倒数第$k$个修车，花费$t$的时间，会对答案产生$t\times k$的贡献。<br>因此从每个顾客向每个技术人员的$n$个点连边，容量为$1$，花费为$t\times k$，然后跑费用流即可。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 200000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, s, t, ans, a[<span class="number">65</span>][<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> pre[MAX_N+<span class="number">5</span>], cnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> v, c, w, nxt;&#125; E[MAX_M+<span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;s = <span class="number">0</span>, t = n*m+n+<span class="number">1</span>, cnt = <span class="number">0</span>;	<span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pre));&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">	E[cnt].v = v, E[cnt].c = c, E[cnt].w = w, E[cnt].nxt = pre[u], pre[u] = cnt++;</span><br><span class="line">	E[cnt].v = u, E[cnt].c = <span class="number">0</span>, E[cnt].w =-w, E[cnt].nxt = pre[v], pre[v] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">SPFA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;	<span class="keyword">bool</span> inque[MAX_N+<span class="number">5</span>];	<span class="keyword">int</span> dis[MAX_N+<span class="number">5</span>], pree[MAX_N+<span class="number">5</span>];</span><br><span class="line">	<span class="built_in">memset</span>(inque, <span class="literal">false</span>, <span class="keyword">sizeof</span>(inque)), <span class="built_in">memset</span>(pree, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pree));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = s; i &lt;= t; i++)	dis[i] = INF;</span><br><span class="line">	dis[s] = <span class="number">0</span>, que.push(s), inque[s] = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">while</span> (!que.empty()) &#123;</span><br><span class="line">		<span class="keyword">int</span> u = que.front();	que.pop(), inque[u] = <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; ~i; i = E[i].nxt) &#123;</span><br><span class="line">			<span class="keyword">int</span> v = E[i].v, c = E[i].c, w = E[i].w;</span><br><span class="line">			<span class="keyword">if</span> (c &amp;&amp; dis[u]+w &lt; dis[v]) &#123;</span><br><span class="line">				dis[v] = dis[u]+w, pree[v] = i;</span><br><span class="line">				<span class="keyword">if</span> (!inque[v])	que.push(v), inque[v] = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (dis[t] == INF)	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">int</span> flow = INF;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pree[t]; ~i; i = pree[E[i^<span class="number">1</span>].v])	flow = min(flow, E[i].c);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pree[t]; ~i; i = pree[E[i^<span class="number">1</span>].v])	E[i].c -= flow, E[i^<span class="number">1</span>].c += flow;</span><br><span class="line">	ans += dis[t];	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;m, &amp;n), init();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i][j]);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	insert(s, i, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)	<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)	insert(i, j*n+k, <span class="number">1</span>, a[i][j]*k);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)	<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)	insert(j*n+k, t, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">while</span> (SPFA()) ;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%.2lf"</span>, (<span class="keyword">double</span>)ans/n);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://azrael.top/HDU4757 Tree LCA+可持久化Trie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Azrael_Death">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/HDU4757 Tree LCA+可持久化Trie/" itemprop="url">HDU4757 Tree <LCA+可持久化Trie></a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-17T00:00:00+08:00">
                2017-10-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,088
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="【LCA-可持久化Trie】Tree"><a href="#【LCA-可持久化Trie】Tree" class="headerlink" title="【LCA+可持久化Trie】Tree"></a>【LCA+可持久化Trie】Tree</h2></blockquote>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>Zero and One are good friends who always have fun with each other.<br>This time, they decide to do something on a tree which is a kind of graph that there is only one path from node to node. First, Zero will give One an tree and every node in this tree has a value. Then, Zero will ask One a series of queries. Each query contains three parameters: $x$, $y$, $z$ which mean that he want to know the maximum value produced by $z$ $xor$ each value on the path from node $x$ to node $y$ (include node $x$, node $y$). Unfortunately, One has no idea in this question. So he need you to solve it.</p>
<blockquote>
</blockquote>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>There are several test cases and the cases end with $EOF$. For each case:<br>The first line contains two integers $n(1\le n\le 10^5)$ and $m(1\le m\le 10^5)$, which are the amount of tree’s nodes and queries, respectively.<br>The second line contains $n$ integers $a[1..n]$ and $a<a href="0\le a[i]&lt;2^{16}">i</a>$ is the value on the $i^{th}$ node.<br>The next $n–1$ lines contains two integers $u$ $v$, which means there is an connection between $u$ and $v$.<br>The next m lines contains three integers $x$ $y$ $z$, which are the parameters of Zero’s query. </p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>For each query, output the answer. </p>
<blockquote>
</blockquote>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">3 2</span><br><span class="line">1 2 2</span><br><span class="line">1 2</span><br><span class="line">2 3</span><br><span class="line">1 3 1</span><br><span class="line">2 3 2</span><br></pre></td></tr></table></figure>
<blockquote>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="Translation"><a href="#Translation" class="headerlink" title="Translation"></a>Translation</h2><p>题目大意：给出一棵树，求两点$x,y$间树上链路中的数异或$z$得到的最大结果。</p>
<p>标签：$LCA+可持久化Trie$</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>最大异或和上树…<br>有异或，一个经典的解法就是建一棵$01$字典树，然后贪心跑一遍，尽量选和给出数当前位不同的数。<br>对于树上的此类问题，可以把$Trie$树可持久化，对于每个点，存它到根节点的路径上所有数的$Trie$树，这样是有前缀和性质的，求$LCA$后作差即可求出链路上的数。<br>可持久化方法和主席树差不多。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_D 15</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, cnt, c[MAX_N+<span class="number">5</span>], root[MAX_N+<span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> anc[MAX_N+<span class="number">5</span>][MAX_D+<span class="number">5</span>], dep[MAX_N+<span class="number">5</span>];</span><br><span class="line"><span class="keyword">bool</span> vis[MAX_N+<span class="number">5</span>];</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; G[MAX_N+<span class="number">5</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> ls, rs, size;&#125; trie[MAX_N*<span class="number">20</span>+<span class="number">500</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	root[<span class="number">0</span>] = cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">memset</span>(root, <span class="number">0</span>, <span class="keyword">sizeof</span>(root));</span><br><span class="line">	<span class="built_in">memset</span>(anc, <span class="number">0</span>, <span class="keyword">sizeof</span>(anc));</span><br><span class="line">	<span class="built_in">memset</span>(dep, <span class="number">0</span>, <span class="keyword">sizeof</span>(dep));</span><br><span class="line">	<span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	G[i].clear();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">	vis[u] = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; (<span class="number">1</span>&lt;&lt;i) &lt;= dep[u]; i++)	anc[u][i] = anc[anc[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++)</span><br><span class="line">		<span class="keyword">if</span> (!vis[G[u][i]])	anc[G[u][i]][<span class="number">0</span>] = u, dep[G[u][i]] = dep[u]+<span class="number">1</span>, DFS(G[u][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i, j;</span><br><span class="line">	<span class="keyword">if</span> (dep[a] &lt; dep[b])	swap(a, b);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; (<span class="number">1</span>&lt;&lt;i) &lt;= dep[a]; i++) ;	i--;</span><br><span class="line">	<span class="keyword">for</span> (j = i; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">		<span class="keyword">if</span> (dep[a]-(<span class="number">1</span>&lt;&lt;j) &gt;= dep[b])</span><br><span class="line">			a = anc[a][j];</span><br><span class="line">	<span class="keyword">if</span> (a == b)	<span class="keyword">return</span> a;</span><br><span class="line">	<span class="keyword">for</span> (j = i; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">		<span class="keyword">if</span> (anc[a][j] != anc[b][j])</span><br><span class="line">			a = anc[a][j], b = anc[b][j];</span><br><span class="line">	<span class="keyword">return</span> anc[a][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> o, <span class="keyword">int</span> val, <span class="keyword">int</span> range)</span> </span>&#123;</span><br><span class="line">	trie[v] = trie[o];</span><br><span class="line">	<span class="keyword">if</span> (range == <span class="number">0</span>) &#123;trie[v].size++; <span class="keyword">return</span>;&#125;</span><br><span class="line">	<span class="keyword">int</span> x = val/range;</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">0</span>)	insert(trie[v].ls = ++cnt, trie[o].ls, val%range, range/<span class="number">2</span>);</span><br><span class="line">	<span class="keyword">else</span>	insert(trie[v].rs = ++cnt, trie[o].rs, val%range, range/<span class="number">2</span>);</span><br><span class="line">	trie[v].size = trie[trie[v].ls].size+trie[trie[v].rs].size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">	root[u] = ++cnt;</span><br><span class="line">	insert(root[u], root[anc[u][<span class="number">0</span>]], c[u], (<span class="number">1</span>&lt;&lt;MAX_D));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++)</span><br><span class="line">		<span class="keyword">if</span> (G[u][i] != anc[u][<span class="number">0</span>])	build(G[u][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> v1, <span class="keyword">int</span> v2, <span class="keyword">int</span> v3, <span class="keyword">int</span> v4, <span class="keyword">int</span> x, <span class="keyword">int</span> range)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (range == <span class="number">0</span>)	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> tmp1 = trie[trie[v1].ls].size+trie[trie[v2].ls].size-trie[trie[v3].ls].size-trie[trie[v4].ls].size;</span><br><span class="line">	<span class="keyword">int</span> tmp2 = trie[trie[v1].rs].size+trie[trie[v2].rs].size-trie[trie[v3].rs].size-trie[trie[v4].rs].size;</span><br><span class="line">	<span class="keyword">if</span> (x/range == <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (tmp2)	<span class="keyword">return</span> range+query(trie[v1].rs, trie[v2].rs, trie[v3].rs, trie[v4].rs, x%range, range/<span class="number">2</span>);</span><br><span class="line">		<span class="keyword">else</span>	<span class="keyword">return</span> query(trie[v1].ls, trie[v2].ls, trie[v3].ls, trie[v4].ls, x%range, range/<span class="number">2</span>);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (tmp1)	<span class="keyword">return</span> range+query(trie[v1].ls, trie[v2].ls, trie[v3].ls, trie[v4].ls, x%range, range/<span class="number">2</span>);</span><br><span class="line">		<span class="keyword">else</span>	<span class="keyword">return</span> query(trie[v1].rs, trie[v2].rs, trie[v3].rs, trie[v4].rs, x%range, range/<span class="number">2</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m) != EOF) &#123;</span><br><span class="line">		init();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;c[i]);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;<span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), G[u].push_back(v), G[v].push_back(u);&#125;</span><br><span class="line">		DFS(<span class="number">1</span>);</span><br><span class="line">		build(<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">while</span> (m--) &#123;</span><br><span class="line">			<span class="keyword">int</span> u, v, x, lca;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;x);	lca = LCA(u, v);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, query(root[u], root[v], root[lca], root[anc[lca][<span class="number">0</span>]], x, (<span class="number">1</span>&lt;&lt;MAX_D)));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)	trie[i].ls = trie[i].rs = trie[i].size = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.gif"
                alt="Azrael_Death" />
            
              <p class="site-author-name" itemprop="name">Azrael_Death</p>
              <p class="site-description motion-element" itemprop="description">Veni, Vidi, Vici</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">120</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">74</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/AzraelDeath" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/azraeldeath" target="_blank" title="ZhiHu">
                      
                        <i class="fa fa-fw fa-globe"></i>ZhiHu</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友链
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.csdn.net/OwenOwl" title="OwenOwl" target="_blank">OwenOwl</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.csdn.net/Joker_69" title="Joker" target="_blank">Joker</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnblogs.com/aziint" title="Aziint" target="_blank">Aziint</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://dangxingyu.com" title="DXY" target="_blank">DXY</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.csdn.net/demon_rieman" title="Demon_Rieman" target="_blank">Demon_Rieman</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.csdn.net/myjs999" title="myjs99" target="_blank">myjs99</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://309459245.lofter.com" title="YJQ" target="_blank">YJQ</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnblogs.com/candy99" title="Candy" target="_blank">Candy</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnblogs.com/zig-zag" title="ZigZag" target="_blank">ZigZag</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://cxjyxx.me" title="cxjyxx_me" target="_blank">cxjyxx_me</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.shuizilong.com" title="ShuiZiLong" target="_blank">ShuiZiLong</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnblogs.com/kuangbin" title="KuangBin" target="_blank">KuangBin</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://acrazyczy.github.io" title="Crazy_Cloud" target="_blank">Crazy_Cloud</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Azrael_Death</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">123.7k</span>
  
</div>


  <div class="powered-by">
  <i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
    本站访客数:<span id="busuanzi_value_site_uv"></span>
  </span>
  </div>
  
  <span class="post-meta-divider">|</span>

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

    
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"sciptForm":"local","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"superSample":2,"width":50,"height":100,"position":"left","hOffset":0,"vOffset":0},"mobile":{"show":false,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2}});</script></body>
</html>
